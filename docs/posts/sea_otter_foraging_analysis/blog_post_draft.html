<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vedika Shirtekar">

<title>Vedika Shirtekar -</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/Professional Logo with Oceanic Theme.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/Professional Logo with Oceanic Theme.png" alt="the name vedika shirtekar with an ocean tech generated icon" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../post.html" rel="" target="">
 <span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html" rel="" target="">
 <span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vedikaS-byte/mysite" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth" id="toc-assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth" class="nav-link active" data-scroll-target="#assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth">Assessing Sea Otter Feeding Habitats Based on Prey Type and Dive Depth</a>
  <ul class="collapse">
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose"><strong>Purpose</strong></a></li>
  <li><a href="#data-importation-exploration-and-cleaning" id="toc-data-importation-exploration-and-cleaning" class="nav-link" data-scroll-target="#data-importation-exploration-and-cleaning">Data Importation, Exploration, and Cleaning</a></li>
  <li><a href="#statistical-model" id="toc-statistical-model" class="nav-link" data-scroll-target="#statistical-model"><strong>Statistical model</strong></a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference"><strong>Inference</strong></a></li>
  <li><a href="#professionalism" id="toc-professionalism" class="nav-link" data-scroll-target="#professionalism"><strong>Professionalism</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">



<section id="assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth" class="level1">
<h1>Assessing Sea Otter Feeding Habitats Based on Prey Type and Dive Depth</h1>
<section id="purpose" class="level3">
<h3 class="anchored" data-anchor-id="purpose"><strong>Purpose</strong></h3>
<p>The sea otter (<em>Enhydra lutris)</em> is a highly social marine mammal that plays a vital role as a keystone species in maintaining the health of kelp forest ecosystems by keeping sea urchin populations in check. While sea otters are primary predators of sea urchins, their diets are shown to be varied. For example, sea otters are known to eat (SOURCE). Sea urchins. Because of their important role as a keystone species, understanding their diet and foraging patterns is essential for assessing feeding preferences and food availability in conservation. [ADD DISTRIBUTION].</p>
<p>This blog post aims to present and discuss the results of a statistical regression analysis conducted on sea otter foraging data collected from visual observations in Prince of Wales, Alaska, by LaRoche et al.&nbsp;(2018). A beta regression using <code>betareg</code> with a zero-adjustment was selected for the analysis in order to assess the proportion of prey not consumed by sea otters during summer 2018. Both the age and sex of observed sea otters were considered as potential confounding variables impacting diving time. The following question was utilized to guide the analysis:</p>
<p><strong>How does prey categorization and dive depth predict the proportion of prey not eaten?</strong></p>
<p>The mean proportion not eaten was modeled using a Beta regression with a logit link, while a precision parameter (φ) captured the variability in proportions around the mean.</p>
<ul>
<li><p>Hypothesis 1:</p>
<ul>
<li><p>H<sub>0</sub>: β<sub>prey_cat_urchins</sub> = 0. There is no difference in the proportion of prey not eaten between</p></li>
<li><p>HA: β<sub>prey_cat_urchins</sub> ≠ 0.</p></li>
</ul></li>
<li><p>Hypothesis 2:</p>
<ul>
<li><p>H0: β<sub>dive_time</sub> = 0</p></li>
<li><p>HA: β<sub>dive_time</sub> ≠ 0</p></li>
</ul></li>
<li></li>
<li><p>The blog post provides context and background for the question</p></li>
<li><p>The data are explained using text and figures</p></li>
<li><p>The relationships and causal relationships are described with a DAG</p></li>
</ul>
</section>
<section id="data-importation-exploration-and-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-importation-exploration-and-cleaning">Data Importation, Exploration, and Cleaning</h3>
<p>This project uses [VARIABLES]:</p>
<ul>
<li></li>
<li></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg) <span class="co"># https://cran.r-project.org/web/packages/betareg/vignettes/betareg.html#sec-model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"forage_final (1).csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [4,457 × 36] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ BoutID                 : chr [1:4457] "2018-001" "2018-001" "2018-001" "2018-001" ...
 $ Study                  : chr [1:4457] "POW" "POW" "POW" "POW" ...
 $ Date                   : chr [1:4457] "5/6/18" "5/6/18" "5/6/18" "5/6/18" ...
 $ BoutStart              : 'hms' num [1:4457] 11:24:00 11:24:00 11:24:00 11:24:00 ...
  ..- attr(*, "units")= chr "secs"
 $ BoutEnd                : 'hms' num [1:4457] 11:51:00 11:51:00 11:51:00 11:51:00 ...
  ..- attr(*, "units")= chr "secs"
 $ DiveNo                 : num [1:4457] 1 2 3 4 5 6 7 8 9 10 ...
 $ DT                     : num [1:4457] 76 135 55 52 40 81 58 46 42 12 ...
 $ ST                     : num [1:4457] 33 26 12 21 17 22 60 9 13 30 ...
 $ Suc                    : chr [1:4457] "N" "Y" "Y" "Y" ...
 $ HT                     : num [1:4457] NA 24 12 21 17 NA 60 9 NA 12 ...
 $ PreyItem               : chr [1:4457] NA "SAG" "CLA" "CLA" ...
 $ PreyQty                : num [1:4457] NA 1 1 2 1 NA 1 1 NA 1 ...
 $ PreySz                 : chr [1:4457] NA "2A" "1C" "1C" ...
 $ PropNotEat             : num [1:4457] NA NA NA NA NA NA 0.3 NA NA NA ...
 $ Why....Notes...Tool.Use: chr [1:4457] NA NA NA NA ...
 $ Region                 : chr [1:4457] "SHINAKU INLET" "SHINAKU INLET" "SHINAKU INLET" "SHINAKU INLET" ...
 $ YEAR                   : num [1:4457] 2003 2003 2003 2003 2003 ...
 $ ObsLatDeg              : num [1:4457] 55.6 55.6 55.6 55.6 55.6 ...
 $ ObsLongDeg             : num [1:4457] -133 -133 -133 -133 -133 ...
 $ OtterLatDeg            : num [1:4457] 55.6 55.6 55.6 55.6 55.6 ...
 $ OtterLongDeg           : num [1:4457] -133 -133 -133 -133 -133 ...
 $ age                    : chr [1:4457] "A" "A" "A" "A" ...
 $ sex                    : chr [1:4457] "U" "U" "U" "U" ...
 $ pup                    : chr [1:4457] NA NA NA NA ...
 $ where                  : chr [1:4457] "OW" "OW" "OW" "OW" ...
 $ obscond                : chr [1:4457] "VG" "VG" "VG" "VG" ...
 $ Rain                   : chr [1:4457] "NONE" "NONE" "NONE" "NONE" ...
 $ Sky                    : num [1:4457] 0 0 0 0 0 0 0 0 0 0 ...
 $ observer               : chr [1:4457] "NLL" "NLL" "NLL" "NLL" ...
 $ recorder               : chr [1:4457] "CLD/YBB" "CLD/YBB" "CLD/YBB" "CLD/YBB" ...
 $ EnteredBy              : chr [1:4457] "NLL" "NLL" "NLL" "NLL" ...
 $ checked.by             : chr [1:4457] "SLK" "SLK" "SLK" "SLK" ...
 $ PreyCat                : chr [1:4457] NA "Clam" "Clam" "Clam" ...
 $ Occupation             : chr [1:4457] "15 years" "15 years" "15 years" "15 years" ...
 $ julian                 : num [1:4457] 126 126 126 126 126 126 126 126 126 126 ...
 $ Season                 : chr [1:4457] "Spring" "Spring" "Spring" "Spring" ...
 - attr(*, "spec")=
  .. cols(
  ..   BoutID = col_character(),
  ..   Study = col_character(),
  ..   Date = col_character(),
  ..   BoutStart = col_time(format = ""),
  ..   BoutEnd = col_time(format = ""),
  ..   DiveNo = col_double(),
  ..   DT = col_double(),
  ..   ST = col_double(),
  ..   Suc = col_character(),
  ..   HT = col_double(),
  ..   PreyItem = col_character(),
  ..   PreyQty = col_double(),
  ..   PreySz = col_character(),
  ..   PropNotEat = col_double(),
  ..   Why....Notes...Tool.Use = col_character(),
  ..   Region = col_character(),
  ..   YEAR = col_double(),
  ..   ObsLatDeg = col_double(),
  ..   ObsLongDeg = col_double(),
  ..   OtterLatDeg = col_double(),
  ..   OtterLongDeg = col_double(),
  ..   age = col_character(),
  ..   sex = col_character(),
  ..   pup = col_character(),
  ..   where = col_character(),
  ..   obscond = col_character(),
  ..   Rain = col_character(),
  ..   Sky = col_double(),
  ..   observer = col_character(),
  ..   recorder = col_character(),
  ..   EnteredBy = col_character(),
  ..   checked.by = col_character(),
  ..   PreyCat = col_character(),
  ..   Occupation = col_character(),
  ..   julian = col_double(),
  ..   Season = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## drop NAs</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(forage))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 BoutID                   Study                    Date 
                      0                       0                       0 
              BoutStart                 BoutEnd                  DiveNo 
                      0                       0                       0 
                     DT                      ST                     Suc 
                      7                     118                       4 
                     HT                PreyItem                 PreyQty 
                    641                     480                     484 
                 PreySz              PropNotEat Why....Notes...Tool.Use 
                    484                    4033                    3049 
                 Region                    YEAR               ObsLatDeg 
                      0                       0                       0 
             ObsLongDeg             OtterLatDeg            OtterLongDeg 
                      0                       0                       0 
                    age                     sex                     pup 
                      0                       0                    3343 
                  where                 obscond                    Rain 
                     19                       0                       0 
                    Sky                observer                recorder 
                      0                       0                       0 
              EnteredBy              checked.by                 PreyCat 
                      0                      28                    1541 
             Occupation                  julian                  Season 
                      0                       0                       0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select for just prey category, diving time, and prey handling time </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># table(forage$age)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># table(forage$sex)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span> <span class="fu">select</span>(BoutID, PreyCat, PreyItem, DT, HT,PropNotEat, age)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span> <span class="fu">filter</span>(age <span class="sc">!=</span> <span class="st">"U"</span>) </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 304   7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the colSums... were they all dropped?</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(forage)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    BoutID    PreyCat   PreyItem         DT         HT PropNotEat        age 
         0          0          0          0          0          0          0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of dive time related to the proportion of prey not eaten based on prey category</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>forage <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DT, <span class="at">y =</span> PropNotEat))<span class="sc">+</span> <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="co">#+ scale_color_discrete(palette = "Set2") + </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   #facet_wrap(~PreyCat, scale = "free") + </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#theme(legend.position = "none") + </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Diving Time (seconds)"</span>, <span class="at">y =</span> <span class="st">"Proportion of Prey Not Eaten"</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">title =</span> <span class="st">"Proportion of Prey Not Consumed By Sea Otters Based on Diving Time"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="blog_post_draft_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots to visualize the distribution of prey categories and proportion of prey not eaten</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>forage <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PreyCat, <span class="at">y =</span> PropNotEat, <span class="at">fill =</span> PreyCat)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="blog_post_draft_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="statistical-model" class="level3">
<h3 class="anchored" data-anchor-id="statistical-model"><strong>Statistical model</strong></h3>
<p>[stat notation]</p>
<p>Here, simulated data was generated to</p>
<p><code>betareg(formula, data, subset, na.action, weights, offset, link = "logit", link.phi = NULL, control = betareg.control(...), model = TRUE, y = TRUE, x = FALSE, ...)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta does not take direct 0 and 1! need to do adjustment to offset before 1 and after 0 ()</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PropNotEat_adj =</span> <span class="co"># Transformation to adjust (betareg cranr)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>           (PropNotEat <span class="sc">*</span> (<span class="fu">nrow</span>(.) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fu">nrow</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with interaction</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>forage_interaction_added <span class="ot">&lt;-</span> <span class="fu">betareg</span>(PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">*</span> DT <span class="sc">+</span> age, <span class="at">data =</span> forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control,
: no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with interaction</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>forage_interaction <span class="ot">&lt;-</span> <span class="fu">betareg</span>(PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">*</span> DT, <span class="at">data =</span> forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control,
: no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with interaction</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>forage_interaction_age <span class="ot">&lt;-</span> <span class="fu">betareg</span>(PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">+</span> DT<span class="sc">*</span>age, <span class="at">data =</span> forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control,
: no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forage_interaction_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = PropNotEat_adj ~ PreyCat + DT * age, data = forage)

Quantile residuals:
    Min      1Q  Median      3Q     Max 
-1.8218 -0.6847 -0.2759  0.0956  2.9494 

Coefficients (mean model with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.659404   0.167937   3.927 8.62e-05 ***
PreyCatCrab     -0.274429   0.165625  -1.657  0.09753 .  
PreyCatCucumber -0.409292   0.238509  -1.716  0.08615 .  
PreyCatStar     -0.012105   0.471555  -0.026  0.97952    
PreyCatUrchin   -0.182964   0.340366  -0.538  0.59089    
DT              -0.004529   0.001481  -3.058  0.00223 ** 
ageJ            -0.824783   2.424516  -0.340  0.73372    
DT:ageJ          0.018273   0.046002   0.397  0.69120    

Phi coefficients (precision model with identity link):
      Estimate Std. Error z value Pr(&gt;|z|)    
(phi)   1.7881     0.1211   14.76   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood: 11.84 on 9 Df
Pseudo R-squared: 0.03302
Number of iterations: 32 (BFGS) + 2 (Fisher scoring) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Control variable/additional variable inclusion beta regression</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>forage_beta <span class="ot">&lt;-</span> <span class="fu">betareg</span>(PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">+</span> DT <span class="sc">+</span> age, <span class="at">data =</span> forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control,
: no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forage_beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = PropNotEat_adj ~ PreyCat + DT + age, data = forage)

Quantile residuals:
    Min      1Q  Median      3Q     Max 
-1.8224 -0.6818 -0.2775  0.0939  2.9459 

Coefficients (mean model with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.659968   0.167951   3.930 8.51e-05 ***
PreyCatCrab     -0.280862   0.164865  -1.704  0.08846 .  
PreyCatCucumber -0.410692   0.238514  -1.722  0.08509 .  
PreyCatStar     -0.013533   0.471602  -0.029  0.97711    
PreyCatUrchin   -0.184814   0.340377  -0.543  0.58715    
DT              -0.004519   0.001481  -3.051  0.00228 ** 
ageJ             0.092024   0.808221   0.114  0.90935    

Phi coefficients (precision model with identity link):
      Estimate Std. Error z value Pr(&gt;|z|)    
(phi)   1.7871     0.1211   14.76   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood: 11.76 on 8 Df
Pseudo R-squared: 0.03259
Number of iterations: 15 (BFGS) + 2 (Fisher scoring) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>forage<span class="sc">$</span>PropNotEat_adj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.69934211 0.99835526 0.79901316 0.50000000 0.50000000 0.50000000
  [7] 0.33055921 0.69934211 0.50000000 0.50000000 0.50000000 0.79901316
 [13] 0.20098684 0.40032895 0.50000000 0.50000000 0.50000000 0.99835526
 [19] 0.10131579 0.20098684 0.99835526 0.10131579 0.50000000 0.50000000
 [25] 0.20098684 0.10131579 0.20098684 0.79901316 0.50000000 0.20098684
 [31] 0.10131579 0.20098684 0.20098684 0.99835526 0.20098684 0.20098684
 [37] 0.33055921 0.50000000 0.25082237 0.50000000 0.50000000 0.79901316
 [43] 0.99835526 0.50000000 0.25082237 0.50000000 0.50000000 0.74917763
 [49] 0.50000000 0.99835526 0.59967105 0.10131579 0.10131579 0.10131579
 [55] 0.50000000 0.50000000 0.79901316 0.50000000 0.50000000 0.30065789
 [61] 0.50000000 0.50000000 0.10131579 0.50000000 0.50000000 0.25082237
 [67] 0.20098684 0.33055921 0.50000000 0.50000000 0.99835526 0.50000000
 [73] 0.74917763 0.50000000 0.33055921 0.33055921 0.99835526 0.50000000
 [79] 0.25082237 0.25082237 0.33055921 0.25082237 0.50000000 0.99835526
 [85] 0.33055921 0.66645066 0.99835526 0.15115132 0.10131579 0.50000000
 [91] 0.40032895 0.74917763 0.20098684 0.20098684 0.20098684 0.33055921
 [97] 0.30065789 0.30065789 0.50000000 0.10131579 0.20098684 0.30065789
[103] 0.25082237 0.10131579 0.10131579 0.30065789 0.50000000 0.25082237
[109] 0.33055921 0.99835526 0.99835526 0.40032895 0.15115132 0.20098684
[115] 0.50000000 0.74917763 0.10131579 0.10131579 0.10131579 0.05148026
[121] 0.50000000 0.10131579 0.50000000 0.99835526 0.50000000 0.33055921
[127] 0.99835526 0.99835526 0.50000000 0.33055921 0.50000000 0.33055921
[133] 0.50000000 0.50000000 0.50000000 0.33055921 0.50000000 0.33055921
[139] 0.99835526 0.50000000 0.50000000 0.25082237 0.25082237 0.40032895
[145] 0.50000000 0.50000000 0.50000000 0.99835526 0.50000000 0.33055921
[151] 0.50000000 0.25082237 0.25082237 0.50000000 0.50000000 0.74917763
[157] 0.25082237 0.25082237 0.99835526 0.50000000 0.40032895 0.30065789
[163] 0.10131579 0.50000000 0.25082237 0.25082237 0.15115132 0.40032895
[169] 0.50000000 0.50000000 0.74917763 0.50000000 0.30065789 0.50000000
[175] 0.33055921 0.50000000 0.33055921 0.10131579 0.20098684 0.20098684
[181] 0.50000000 0.15115132 0.15115132 0.30065789 0.10131579 0.33055921
[187] 0.50000000 0.74917763 0.33055921 0.33055921 0.99835526 0.25082237
[193] 0.99835526 0.99835526 0.74917763 0.50000000 0.25082237 0.50000000
[199] 0.25082237 0.25082237 0.99835526 0.25082237 0.50000000 0.50000000
[205] 0.50000000 0.50000000 0.65947368 0.99835526 0.50000000 0.74917763
[211] 0.99835526 0.99835526 0.10131579 0.59967105 0.30065789 0.20098684
[217] 0.25082237 0.10131579 0.99835526 0.99835526 0.25082237 0.25082237
[223] 0.25082237 0.50000000 0.50000000 0.99835526 0.50000000 0.15115132
[229] 0.25082237 0.25082237 0.50000000 0.50000000 0.10131579 0.25082237
[235] 0.10131579 0.25082237 0.10131579 0.79901316 0.50000000 0.05148026
[241] 0.10131579 0.74917763 0.50000000 0.50000000 0.50000000 0.74917763
[247] 0.50000000 0.25082237 0.25082237 0.50000000 0.50000000 0.50000000
[253] 0.50000000 0.50000000 0.74917763 0.33055921 0.50000000 0.33055921
[259] 0.50000000 0.50000000 0.65947368 0.50000000 0.99835526 0.99835526
[265] 0.50000000 0.50000000 0.50000000 0.50000000 0.50000000 0.33055921
[271] 0.50000000 0.50000000 0.50000000 0.99835526 0.33055921 0.50000000
[277] 0.99835526 0.50000000 0.50000000 0.50000000 0.50000000 0.25082237
[283] 0.50000000 0.25082237 0.10131579 0.10131579 0.25082237 0.74917763
[289] 0.89868421 0.74917763 0.25082237 0.50000000 0.50000000 0.50000000
[295] 0.50000000 0.50000000 0.50000000 0.50000000 0.74917763 0.50000000
[301] 0.74917763 0.33055921 0.50000000 0.33055921</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>forage_org <span class="ot">&lt;-</span> <span class="fu">betareg</span>(PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">+</span> DT, <span class="at">data =</span> forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control,
: no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(forage_interaction)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models (lowest AIC) (Akaike's An Information Criterion for log-link)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(forage_interaction_added, forage_interaction, forage_interaction_age, forage_beta, forage_org)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         df         AIC
forage_interaction_added 12  0.09461034
forage_interaction       11 -1.88836548
forage_interaction_age    9 -5.67544028
forage_beta               8 -7.51623184
forage_org                7 -9.50307511</code></pre>
</div>
</div>
<ul>
<li><p>The statistical model is explained conceptually and using formal statistical notation</p></li>
<li><p>The blog post demonstrates how to simulate data according to model assumptions</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create simulated dataset (values for predictions) </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>simulated_forage <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">PreyCat =</span> <span class="fu">levels</span>(<span class="fu">factor</span>(forage<span class="sc">$</span>PreyCat)),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#age = levels(factor(forage$age)),</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#sex = levels(factor(forage$sex)),</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">DT =</span> <span class="fu">seq</span>(<span class="fu">min</span>(forage<span class="sc">$</span>DT), <span class="fu">max</span>(forage<span class="sc">$</span>DT), <span class="at">length.out =</span> <span class="dv">40</span>) <span class="co"># 100 obs yeilds closest recovered parameter values</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(simulated_forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   200 obs. of  2 variables:
 $ PreyCat: Factor w/ 5 levels "Clam","Crab",..: 1 2 3 4 5 1 2 3 4 5 ...
 $ DT     : num  3 3 3 3 3 ...
 - attr(*, "out.attrs")=List of 2
  ..$ dim     : Named int [1:2] 5 40
  .. ..- attr(*, "names")= chr [1:2] "PreyCat" "DT"
  ..$ dimnames:List of 2
  .. ..$ PreyCat: chr [1:5] "PreyCat=Clam" "PreyCat=Crab" "PreyCat=Cucumber" "PreyCat=Star" ...
  .. ..$ DT     : chr [1:40] "DT=  3.000000" "DT=  9.435897" "DT= 15.871795" "DT= 22.307692" ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract fitted param (phi and mean)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>coef_vector <span class="ot">&lt;-</span> <span class="fu">coef</span>(forage_org) <span class="co"># Create vector of the coefficients</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>coef_mean <span class="ot">&lt;-</span> coef_vector[<span class="fu">names</span>(coef_vector) <span class="sc">!=</span> <span class="st">"(phi)"</span>] <span class="co"># Do not include phi in estimates</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>sim_phi <span class="ot">&lt;-</span> <span class="fu">coef</span>(forage_org)[<span class="dv">7</span>] <span class="co"># phi (precision) parameter</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict mean response for all predictors</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>mu_response_sim <span class="ot">&lt;-</span> <span class="fu">predict</span>(forage_org,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">newdata =</span> simulated_forage,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">"response"</span>) <span class="co"># I just set it to response bc I don't think we need link space here... no need to undo with plogis since not in link space</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall the equation for parameterization of alpha and beta (https://search.r-project.org/CRAN/refmans/betareg/html/dbetar.html)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> mu_response_sim <span class="sc">*</span> sim_phi</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>mu_response_sim) <span class="sc">*</span> sim_phi</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate on response using rbeta()... generate random values in (0,1) using predicted mean and precision</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>simulated_forage<span class="sc">$</span>PropNotEat_adj <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="fu">nrow</span>(simulated_forage), alpha, beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Refit model with simulated data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sim_forage_model <span class="ot">&lt;-</span> <span class="fu">betareg</span>(PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">+</span> DT, <span class="at">data =</span> simulated_forage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control,
: no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to compare coefficents (convert to kable extra)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>original_recovered_coef <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">term =</span> <span class="fu">names</span>(coef_mean),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">original =</span> coef_mean,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">recovered =</span> <span class="fu">coef</span>(sim_forage_model)[<span class="fu">names</span>(coef_mean)]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(original_recovered_coef, <span class="at">n=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           term     original    recovered
(Intercept)         (Intercept)  0.661698472  0.468304173
PreyCatCrab         PreyCatCrab -0.280232706 -0.030074480
PreyCatCucumber PreyCatCucumber -0.411384070 -0.380476013
PreyCatStar         PreyCatStar -0.014339710  0.085942159
PreyCatUrchin     PreyCatUrchin -0.184978548  0.229856298
DT                           DT -0.004531323 -0.004103654</code></pre>
</div>
</div>
<ul>
<li>The blog post demonstrates that a model fit to the simulated data recovers the parameters</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to run this workflow many times... generate lots of sampled coefs</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>simulate_forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span> <span class="fu">select</span>(DT, PreyCat)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>simulate_beta_and_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(model_fit, data){</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create prediction values for the mean</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  sim_mean <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_fit, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"response"</span>) <span class="co"># stay in response space </span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use '$' to extract phi from coefficients</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  sim_phi <span class="ot">&lt;-</span>  model_fit<span class="sc">$</span>coefficients<span class="sc">$</span>precision <span class="co"># phi (precision) parameter</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reparamiterize alpha and beta ()</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> sim_mean <span class="sc">*</span> sim_phi</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>sim_mean) <span class="sc">*</span> sim_phi</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate response (PropNotEat_adj) with rbeta() syntax</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>PropNotEat_adj <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="fu">nrow</span>(data), alpha, beta)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit model on simulated data</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  sim_forage_model <span class="ot">&lt;-</span> <span class="fu">betareg</span>(PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">+</span> DT, <span class="at">data =</span> data)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract original and simulated means</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  coef_mean <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_fit)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  coef_recovered  <span class="ot">&lt;-</span> <span class="fu">coef</span>(sim_forage_model)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return data frame</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  original_recovered_coefs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">names</span>(coef_mean), <span class="co"># Predictor/coefficient name</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">original =</span> coef_mean, <span class="co"># Original model (forage_org) </span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered =</span> coef_recovered[<span class="fu">names</span>(coef_mean)]</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate 50 times using map_dfr()</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>coef_sim_df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="co"># Sequence of numbers to simulate by</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Create a function to run simulation function multiple times</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">function</span>(x) <span class="fu">simulate_beta_and_fit</span>(forage_org, simulate_forage))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inference" class="level3">
<h3 class="anchored" data-anchor-id="inference"><strong>Inference</strong></h3>
<ul>
<li><p>Hypotheses are stated in plain language and with visualizations</p></li>
<li><p>Model estimates are presented with appropriate uncertainty (e.g., confidence inter</p></li>
<li><p>vals)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to generate boot samples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>A hypothesis is tested and the evidence is interpreted</li>
</ul>
</section>
<section id="professionalism" class="level3">
<h3 class="anchored" data-anchor-id="professionalism"><strong>Professionalism</strong></h3>
<ul>
<li><p>The overall appearance of the blog post (e.g., figures, code outputs) is portfolio-quality</p></li>
<li><p>The writing is comprehensible to a technical audience</p></li>
<li><p>The code is well-organized and appropriately documented</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2025, Vedika Shirtekar</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>