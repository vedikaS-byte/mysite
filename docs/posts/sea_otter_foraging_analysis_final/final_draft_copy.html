<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vedika Shirtekar">

<title>Vedika Shirtekar -</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/Professional Logo with Oceanic Theme.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/Professional Logo with Oceanic Theme.png" alt="the name vedika shirtekar with an ocean tech generated icon" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../post.html" rel="" target="">
 <span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html" rel="" target="">
 <span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vedikaS-byte/mysite" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth" id="toc-assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth" class="nav-link active" data-scroll-target="#assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth">Assessing Sea Otter Feeding Habitats Based on Prey Type and Dive Depth</a>
  <ul class="collapse">
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose">Purpose</a></li>
  <li><a href="#data-availability-and-characteristics" id="toc-data-availability-and-characteristics" class="nav-link" data-scroll-target="#data-availability-and-characteristics">Data Availability and Characteristics</a>
  <ul class="collapse">
  <li><a href="#data-access" id="toc-data-access" class="nav-link" data-scroll-target="#data-access">Data Access</a></li>
  <li><a href="#data-importation-exploration-and-processing" id="toc-data-importation-exploration-and-processing" class="nav-link" data-scroll-target="#data-importation-exploration-and-processing">Data Importation, Exploration, and Processing</a></li>
  <li><a href="#data-simulation-procedure" id="toc-data-simulation-procedure" class="nav-link" data-scroll-target="#data-simulation-procedure">Data Simulation Procedure</a></li>
  </ul></li>
  <li><a href="#inference-and-hypothesis-testing-with-beta-regression" id="toc-inference-and-hypothesis-testing-with-beta-regression" class="nav-link" data-scroll-target="#inference-and-hypothesis-testing-with-beta-regression">Inference and Hypothesis Testing with Beta Regression</a></li>
  <li><a href="#confidence-intervals-for-model-coefficients-and-predictions" id="toc-confidence-intervals-for-model-coefficients-and-predictions" class="nav-link" data-scroll-target="#confidence-intervals-for-model-coefficients-and-predictions">Confidence Intervals for Model Coefficients and Predictions</a>
  <ul class="collapse">
  <li><a href="#interpreting-model-β-confidence-intervals" id="toc-interpreting-model-β-confidence-intervals" class="nav-link" data-scroll-target="#interpreting-model-β-confidence-intervals"><strong>Interpreting Model β Confidence Intervals</strong></a></li>
  <li><a href="#interpreting-confidence-intervals-of-predicted-outcomes" id="toc-interpreting-confidence-intervals-of-predicted-outcomes" class="nav-link" data-scroll-target="#interpreting-confidence-intervals-of-predicted-outcomes">Interpreting Confidence Intervals of Predicted Outcomes</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">



<section id="assessing-sea-otter-feeding-habitats-based-on-prey-type-and-dive-depth" class="level1">
<h1>Assessing Sea Otter Feeding Habitats Based on Prey Type and Dive Depth</h1>
<section id="purpose" class="level2">
<h2 class="anchored" data-anchor-id="purpose">Purpose</h2>
<p>The sea otter (<em>Enhydra lutris</em>) is a highly social marine mammal that plays a vital role as a keystone species in maintaining the health of kelp forest ecosystems by controlling sea urchin populations. Although sea otters are primary predators of sea urchins, their diet is diverse and includes a wide variety of prey types. For example, sea otters in Alaska are known to consume a wide range of prey, including clams, crabs, sea urchins, sea cucumbers, and snails (LaRoche et al., 2023). In recolonized areas of Southeast Alaska, clams are strongly selected despite their relatively low abundance, reflecting their high quality value. Similarly, sea urchins dominate diets primarily in rocky reef habitats where they are more abundant (LaRoche et al., 2023).</p>
<p><img src="images/clipboard-1982355787.png" class="img-fluid"></p>
<p>The proportion of prey not eaten provides a measure of foraging efficiency and prey handling success, reflecting both biological constraints and behavioral choices during feeding. Because of their important role as a keystone species, understanding their diet and foraging patterns is essential for assessing feeding preferences and food availability in conservation.</p>
<p>This blog post aims to present and discuss the results of a statistical regression analysis conducted on sea otter foraging data collected from visual observations in Prince of Wales, Alaska, by LaRoche et al.&nbsp;(2018). A beta regression using <code>glmmTMB</code> with a zero-adjustment was selected for the analysis in order to assess the proportion of prey not consumed by sea otters during summer 2018. The following question was utilized to guide the analysis:</p>
<p><strong>How does prey categorization and dive depth predict the proportion of prey not eaten?</strong></p>
<p>The mean proportion not eaten was modeled using a Beta regression with a logit link, while a precision parameter (ϕ) captured the variability in proportions around the mean.</p>
<p><span class="math display">\[
\text{PropNotEaten} \sim \text{Beta}(\alpha, \beta)
\]</span></p>
<p><span class="math display">\[
logit(\mu_i)
= \beta_{0}
+ \beta_{diveTime}
+ \beta_{PreyCat\_urchin}
+ \beta_{PreyCat\_crab}
+ \beta_{PreCat\_cucumber}
+ \beta_{PreCat\_star}  
\]</span></p>
<ul>
<li><p><strong>Hypothesis 1:</strong></p>
<ul>
<li><p>H<sub>0</sub>: β<sub>PreyCat_urchins</sub> = 0. Sea otters leave the same proportion of urchins uneaten as they do with clams; prey category does not influence the proportion of prey eaten.</p></li>
<li><p>H<sub>A</sub>: β<sub>PreyCat_urchins</sub> ≠ 0. Sea otters leave a significantly different proportion of urchins uneaten compared to clams; prey category has a significant effect on the proportion of prey not eaten.</p></li>
</ul></li>
<li><p><strong>Hypothesis 2</strong>:</p>
<ul>
<li><p>H<sub>0</sub>: β<sub>dive_time</sub> = 0. Dive time has no significant effect on the proportion of prey not eaten; the duration of a dive does not influence how much prey is not eaten.</p></li>
<li><p>H<sub>A</sub>: β<sub>dive_time</sub> ≠ 0. Dive time does significantly affect the proportion of prey not eaten; longer or shorter dives are associated with a higher or lower proportion of prey left uneaten.</p></li>
</ul></li>
</ul>
<p>The categorical variable <code>PreyCat</code> represents the general prey categorization of a prey type. In particular, clams and urchins differ biologically in handling difficulty and energetic return. Urchins may require more processing and include defensive structures (spines), whereas clams require shell-breaking but offer concentrated soft tissue. These differences potentially influence the proportion of prey successfully consumed, indicating a direct causal effect of prey category on the proportion of prey not consumed</p>
<p>Additionally, prey category may influence dive duration (continuous numeric variable) because hunting, handling, and extracting different prey may require different levels of effort and time. Thus, prey category potentially influences dive time, which in turn affects the proportion of prey not eaten.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DAG using dagitty package... relate to each variable </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">"dag { </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">  PreyCat -&gt; DT </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">  DT -&gt; PropNotEat</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">  PreyCat -&gt; PropNotEat</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">}"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dag) <span class="co"># Visualize DAG</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_draft_copy_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="data-availability-and-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="data-availability-and-characteristics">Data Availability and Characteristics</h2>
<section id="data-access" class="level3">
<h3 class="anchored" data-anchor-id="data-access">Data Access</h3>
<p>The data used in this project were obtained from the <a href="https://knb.ecoinformatics.org/view/doi%3A10.5063%2FF1C53J8X">KNB Data Repository</a> and are based on the finalized foraging dataset “Sea otter foraging data, visual observations from Prince of Wales, Alaska<em>”</em> compiled by Nicole LaRoche, Sydney King, and Heidi Pearson (2022). LaRoche et al.&nbsp;documented sea otter diets from May to August 2018 using visual observations conducted along the western coast of Prince of Wales Island, Alaska, at sites characterized by high otter densities. The finalized foraging dataset is publicly accessible as a CSV file through the KNB Data Repository.</p>
</section>
<section id="data-importation-exploration-and-processing" class="level3">
<h3 class="anchored" data-anchor-id="data-importation-exploration-and-processing">Data Importation, Exploration, and Processing</h3>
<p>The foraging dataset used in this project had been previously cleaned by the original authors. However, additional processing was required, including adjusting variables to appropriate ranges and removing missing values. Therefore, further preprocessing steps were necessary before conducting the analyses.</p>
<p>Here, I loaded the necessary packages for the analysis and then imported the dataset by providing the correct file path to <code>read_csv()</code>.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)         </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># For tidy glmmTMB mixed model</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"forage_final (1)_copy.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Missing values (NAs) were removed prior to analysis. I then selected only the variables required for modeling: prey category (<code>PreyCat</code>), dive time (<code>DT</code>), and proportion not eaten (<code>PropNotEat</code>). Additionally, I generated a summary table showing the number of observations within each prey category and verified that all <code>NAs</code> had been removed from the selected variables using <code>colSums()</code> in combination with <code>is.na()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select for just prey category and diving time</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span> <span class="fu">select</span>(PreyCat, PropNotEat, DT)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(forage<span class="sc">$</span>PreyCat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clam     Crab Cucumber     Star   Urchin 
     205       71       28        7       12 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the colSums to ensure all NAs are dropped</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(forage)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   PreyCat PropNotEat         DT 
         0          0          0 </code></pre>
</div>
</div>
<p>Visualizing the initial data distribution was also helpful. I opted to use a scatterplot to show the relationship between dive time (a continuous numeric variable) and the proportion of prey not eaten by prey category, along with a boxplot to display the distribution of uneaten prey within each category.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of dive time related to the proportion of prey not eaten based on prey category</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>forage <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DT, <span class="at">y =</span> PropNotEat, <span class="at">col =</span> PreyCat)) <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()  <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Diving Time (seconds)"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Prey Not Eaten"</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Proportion of Prey Not Consumed By Sea Otters Based on Diving Time and /nPrey Category"</span>) <span class="sc">+</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_draft_copy_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots to visualize the distribution of prey categories and proportion of prey not eaten</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>forage <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PreyCat, <span class="at">y =</span> PropNotEat, <span class="at">fill =</span> PreyCat)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Proportion of Prey Not Consumed By Sea Otters Based on Prey Category"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Prey Category"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proportion of Prey Not Consumed"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Clam"</span> <span class="ot">=</span> <span class="st">"#1b9e77"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Urchin"</span> <span class="ot">=</span> <span class="st">"#d95f02"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crab"</span> <span class="ot">=</span> <span class="st">"#7570b3"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cucumber"</span> <span class="ot">=</span> <span class="st">"#66a61e"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Star"</span> <span class="ot">=</span> <span class="st">"#e6ab02"</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_draft_copy_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the scatterplot, it appears that sea otters spending roughly 25-100 seconds on prey often leave around 50% or even 100% of clams and crabs uneaten, suggesting potentially wasteful behavior. Most prey left uneaten cluster around 50% for clams, crabs, and sea cucumbers, and between 25-175 seconds for sea urchins. Notably, longer prey handling times, which are associated with deeper dives, are linked to lower proportions of prey left uneaten, typically under 25-50%, especially for clams, urchins, and crabs. The boxplot shows that starfish have a higher median proportion left uneaten than other prey categories, while sea cucumbers have the lowest median. Sea urchins also tend to be left uneaten less often than clams.</p>
</section>
<section id="data-simulation-procedure" class="level3">
<h3 class="anchored" data-anchor-id="data-simulation-procedure">Data Simulation Procedure</h3>
<p>Before building a model using real world data, it is important to simulate data to ensure that the model performs as expected. In this case, I generated simulated data to evaluate model performance, assess parameter recovery, and verify that the fitted model behaves appropriately.</p>
<p>According to the <code>betareg</code> CRAN project, a variable cannot take exact values of 0 or 1. Therefore, a zero-adjustment is required to slightly decrease values of 1 to just below 1 and slightly increase values of 0 to just above 0. To adjust the response variable <code>PropNotEat</code> to the corrected range, I applied the zero-adjustment formula from the <code>betareg</code> vignette : <span class="math inline">\(y_{\text{adj}} = \frac{y \cdot (n - 1) + 0.5}{n}\)</span>, where <em>n</em> is the sample size (Smithson and Verkuilen, 2006).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta does not take direct 0 and 1, so do adjustment to offset before 1 and after 0</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>forage <span class="ot">&lt;-</span> forage <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PropNotEat_adj =</span> <span class="co"># Transformation to adjust (betareg cranr)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>           (PropNotEat <span class="sc">*</span> (<span class="fu">nrow</span>(.) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fu">nrow</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I was particularly interested in whether an interaction existed between dive time and prey category. To determine the most appropriate model, I fitted each candidate model using <code>glmmTMB()</code> with a <code>beta_family()</code> and logit link. I then compared models using Akaike’s Information Criterion (AIC) to identify the lowest score. The model <code>PropNotEat_adj ~ DT + PreyCat</code> had the lowest (most negative) AIC, indicating the best balance between fit and simplicity. Therefore, this model was selected for further analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original model</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>forage_beta <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  PropNotEat_adj <span class="sc">~</span> DT <span class="sc">+</span> PreyCat,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> forage,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with interaction between PreyCat and DT</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>forage_interaction <span class="ot">&lt;-</span> forage_org <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  PropNotEat_adj <span class="sc">~</span> PreyCat <span class="sc">*</span> DT,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> forage,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models (lowest AIC) (Akaike's An Information Criterion for log-link)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(forage_beta, forage_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   df       AIC
forage_beta         7 -21.95160
forage_interaction 11 -14.69916</code></pre>
</div>
</div>
<p>To assess model performance and parameter recovery, I simulated 15,000 observations based on the original model coefficients. Dive time (DT) was drawn from a uniform distribution, and prey category (PreyCat) was randomly assigned.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset seed (redefined)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define simulated obs... with law of large numbers, larger sample size should get closer to actual predictors</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">15000</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define coefficients from original model</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fl">0.738077</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>beta_dive_time <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.004949</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>beta_crab <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.265717</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>beta_cucumber <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.449131</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>beta_star <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.240470</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>beta_urchin <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="fl">0.205423</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fl">1.72</span> <span class="co"># Precision</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate range for predictors</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_sim, <span class="dv">3</span>, <span class="dv">255</span>) <span class="co"># Range of dive time</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly generate PreyCat factors for simulated data... then for each level, sample with replacement to get vector of length n_sim</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>PreyCat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Clam"</span>,<span class="st">"Crab"</span>,<span class="st">"Cucumber"</span>,<span class="st">"Star"</span>,<span class="st">"Urchin"</span>), n_sim, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Define linear predictor and logit equation</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign coefficient to each PreyCat level</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>prey_effect <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(PreyCat <span class="sc">==</span> <span class="st">"Crab"</span>, beta_crab,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ifelse</span>(PreyCat <span class="sc">==</span> <span class="st">"Cucumber"</span>, beta_cucumber,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ifelse</span>(PreyCat <span class="sc">==</span> <span class="st">"Star"</span>, beta_star,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ifelse</span>(PreyCat <span class="sc">==</span> <span class="st">"Urchin"</span>, beta_urchin, </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>)))) <span class="co"># Else assign clam (reference)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A linear predictor combining dive time and prey effects was calculated on the logit scale and transformed to the response scale. Each observation was then reparameterized into <code>alpha</code> and <code>beta</code> parameters (derived from the <code>betareg</code> CRAN project) for the beta distribution using the mean and precision. <code>PropNotEat_adj</code> values were simulated accordingly using <code>rbeta()</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>glm_eq <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta_dive_time <span class="sc">*</span> dt <span class="sc">+</span> prey_effect <span class="co"># Recall that prey_effect has the associated beta coefficient for each level</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert linear predictor (logit scale) to  mean proportion on response scale</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>mean_sim <span class="ot">&lt;-</span> <span class="fu">exp</span>(glm_eq) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(glm_eq))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Reparameterize beta distribution parameters (derived from CRAN at (https://search.r-project.org/CRAN/refmans/betareg/html/dbetar.html)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> mean_sim <span class="sc">*</span> phi</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> mean_sim) <span class="sc">*</span> phi</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate response variable from beta distribution using calculated alpha and beta </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>PropNotEat_adj <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_sim, alpha, beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The resulting dataset was fitted with <code>glmmTMB()</code> using a beta family and logit link to verify that the model could recover the original relationships.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create simulated data frame</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>simulated_forage <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">PropNotEat_adj =</span> PropNotEat_adj,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">DT =</span> dt,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">PreyCat =</span> <span class="fu">factor</span>(PreyCat, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Clam"</span>,<span class="st">"Crab"</span>,<span class="st">"Cucumber"</span>,<span class="st">"Star"</span>,<span class="st">"Urchin"</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit simulated model</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>sim_model <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  PropNotEat_adj <span class="sc">~</span> DT <span class="sc">+</span> PreyCat,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simulated_forage,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare coefficients</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create tidy table with broom package</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>sim_tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(sim_model) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Simulated"</span>)  <span class="co"># Add column to identify model</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create tidy table for original model coefficients</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>original_tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(forage_beta) <span class="sc">%&gt;%</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Original"</span>)  <span class="co"># Add column to identify model</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into table for comparison</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>coef_comparison <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sim_tidy, original_tidy)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># View table</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>coef_comparison <span class="sc">%&gt;%</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, model) <span class="sc">%&gt;%</span> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()   <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.7406679</td>
<td style="text-align: right;">0.0270753</td>
<td style="text-align: left;">Simulated</td>
</tr>
<tr class="even">
<td style="text-align: left;">DT</td>
<td style="text-align: right;">-0.0050162</td>
<td style="text-align: right;">0.0001319</td>
<td style="text-align: left;">Simulated</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatCrab</td>
<td style="text-align: right;">-0.2196297</td>
<td style="text-align: right;">0.0297231</td>
<td style="text-align: left;">Simulated</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatCucumber</td>
<td style="text-align: right;">-0.4368883</td>
<td style="text-align: right;">0.0297059</td>
<td style="text-align: left;">Simulated</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatStar</td>
<td style="text-align: right;">-0.2597803</td>
<td style="text-align: right;">0.0297271</td>
<td style="text-align: left;">Simulated</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatUrchin</td>
<td style="text-align: right;">-0.2300222</td>
<td style="text-align: right;">0.0296505</td>
<td style="text-align: left;">Simulated</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.7519842</td>
<td style="text-align: right;">0.1663546</td>
<td style="text-align: left;">Original</td>
</tr>
<tr class="even">
<td style="text-align: left;">DT</td>
<td style="text-align: right;">-0.0050369</td>
<td style="text-align: right;">0.0014648</td>
<td style="text-align: left;">Original</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatCrab</td>
<td style="text-align: right;">-0.2044587</td>
<td style="text-align: right;">0.1603907</td>
<td style="text-align: left;">Original</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatCucumber</td>
<td style="text-align: right;">-0.4937948</td>
<td style="text-align: right;">0.2334250</td>
<td style="text-align: left;">Original</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatStar</td>
<td style="text-align: right;">-0.2481334</td>
<td style="text-align: right;">0.4475516</td>
<td style="text-align: left;">Original</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatUrchin</td>
<td style="text-align: right;">-0.2071764</td>
<td style="text-align: right;">0.3396317</td>
<td style="text-align: left;">Original</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Here, it is observable that the coefficients for each predictor in the simulated model closely match those from the original model fitted to the real data. This indicates that the beta regression is able to reliably recover the underlying parameter relationships.</p>
</section>
</section>
<section id="inference-and-hypothesis-testing-with-beta-regression" class="level2">
<h2 class="anchored" data-anchor-id="inference-and-hypothesis-testing-with-beta-regression">Inference and Hypothesis Testing with Beta Regression</h2>
<p>Beta regression was specifically chosen for this analysis because the response variable, <code>PropNotEat_adj</code>, is proportional. Recall the definition of the beta distribution used in the model:</p>
<p><span class="math display">\[
\text{PropNotEaten} \sim \text{Beta}(\alpha, \beta)
\]</span><span class="math display">\[
logit(\mu_i)
= \beta_{0}
+ \beta_{diveTime}
+ \beta_{PreyCat\_urchin}
+ \beta_{PreyCat\_crab}
+ \beta_{PreyCat\_cucumber}
+ \beta_{PreyCat\_star}  \]</span></p>
<section id="hypothesis-testing-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="hypothesis-testing-interpretation">Hypothesis Testing Interpretation</h4>
<p>The beta regression results were used to test whether prey category and dive time influence the proportion of prey left uneaten. Here, I interpreted the model results to assess whether each hypothesis is supported.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create cleaned summary output table</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(forage_beta) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate  =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">2</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">round</span>(statistic, <span class="dv">2</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">round</span>(p.value, <span class="dv">3</span>)    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, statistic, p.value) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">4.52</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">DT</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-3.44</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatCrab</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">0.202</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatCucumber</td>
<td style="text-align: right;">-0.49</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">-2.12</td>
<td style="text-align: right;">0.034</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatStar</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">0.579</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatUrchin</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">0.542</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="hypothesis-1" class="level4">
<h4 class="anchored" data-anchor-id="hypothesis-1">Hypothesis 1</h4>
<ul>
<li><p>H<sub>0</sub>: β<sub>PreyCat_urchins</sub> = 0.</p></li>
<li><p>H<sub>A</sub>: β<sub>PreyCat_urchins</sub> ≠ 0.</p></li>
</ul>
<p>Based on the model, the coefficient for urchins compared to clams was not significant, indicating that sea otters do not leave a significantly different proportion of urchins uneaten (β = -0.21, p = 0.54). Thus, we fail to reject the null hypothesis that sea otters leave the same proportion of urchins uneaten as they do with clams; prey category does not appear to affect the proportion of prey left uneaten for urchins.</p>
</section>
<section id="hypothesis-2" class="level4">
<h4 class="anchored" data-anchor-id="hypothesis-2">Hypothesis 2</h4>
<ul>
<li><p>H<sub>0</sub>: β<sub>dive_time</sub> = 0.</p></li>
<li><p>H<sub>A</sub>: β<sub>dive_time</sub> ≠ 0.</p></li>
</ul>
<p>Based on the model, dive time had a significant negative effect on the proportion of prey not eaten, indicating that longer dives are associated with a slightly lower proportion of prey left uneaten (β = -0.005, p = 0.0006). As a result, we can reject the null hypothesis that the duration of a dive has no significant effect on the prey not consumed; there is sufficient statistical evidence to suggest that dive duration significantly influences the proportion of prey not consumed.</p>
</section>
</section>
<section id="confidence-intervals-for-model-coefficients-and-predictions" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-for-model-coefficients-and-predictions">Confidence Intervals for Model Coefficients and Predictions</h2>
<p>Confidence intervals are essential for interpreting model estimates because they can be used to quantify uncertainty and interpret effect size. Confidence intervals can be calculated for individual model coefficients, indicating the range in which the true beta value is expected to fall approximately 95% of the time. Alternatively, confidence intervals can be constructed for predicted values of the response variable, showing the range in which the mean response is expected to fall about 95% of the time.</p>
<section id="interpreting-model-β-confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-model-β-confidence-intervals"><strong>Interpreting Model β Confidence Intervals</strong></h3>
<p>I derived confidence intervals from the fitted model <code>forage_beta</code> using <code>confint()</code>. Note that these intervals are on the link scale, so they are not directly interpretable as proportions without transforming from the logit scale.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall that still in link space</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ci_forage <span class="ot">&lt;-</span> <span class="fu">confint</span>(forage_beta)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Style with kableExtra</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ci_forage,<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">DT</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatCrab</td>
<td style="text-align: right;">-0.52</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatCucumber</td>
<td style="text-align: right;">-0.95</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreyCatStar</td>
<td style="text-align: right;">-1.13</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">-0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">PreyCatUrchin</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">-0.21</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The confidence interval for dive time is negative, indicating that longer dives are potentially associated with a slightly lower proportion of prey left uneaten. The confidence interval for <code>PreyCatCucumber</code> is negative and does not include zero, indicating that sea cucumbers are left uneaten significantly less often than clams (reference prey category).</p>
<p>The confidence intervals for <code>PreyCatCrab</code>, <code>PreyCatStar</code>, and <code>PreyCatUrchin</code> all include zero, indicating that the proportion of these prey categories left uneaten are not significant different from clams. Overall, the confidence intervals of each predictor align with the p values from the beta regression model output; significant effects are reflected by the intervals that do not include zero, while the nonsignificant effects have intervals than include zero.</p>
</section>
<section id="interpreting-confidence-intervals-of-predicted-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-confidence-intervals-of-predicted-outcomes">Interpreting Confidence Intervals of Predicted Outcomes</h3>
<p>The uncertainty in the proportion of urchins and clams left uneaten was of interest and can be visualized using a ribbon graph among predicted lines from the model.</p>
<p>I created a prediction grid to explore how dive time (<code>DT</code>) and prey category (<code>PreyCat</code>) influence the proportion of prey left uneaten by sea otters (<code>PropNotEat_adj</code>). I generated a sequence of 100 evenly time-spaced dive times, then combined these with all levels of <code>PreyCat</code>. I then ensured that the <code>PreyCat</code> factor levels in the prediction grid matched those in the original dataset.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build prediction grid of all combinations of DT and PreyCat </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>predicted_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Establish sequence for predictor range (DT)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">DT =</span> <span class="fu">seq</span>(<span class="fu">min</span>(forage<span class="sc">$</span>DT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(forage<span class="sc">$</span>DT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">PreyCat =</span> <span class="fu">levels</span>(<span class="fu">factor</span>(forage<span class="sc">$</span>PreyCat)) <span class="co"># Convert to factor</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure levels in predicted_data exactly match in forage$PreyCat</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>PreyCat <span class="ot">&lt;-</span> <span class="fu">factor</span>(predicted_data<span class="sc">$</span>PreyCat, <span class="at">levels =</span> <span class="fu">levels</span>(<span class="fu">factor</span>(forage<span class="sc">$</span>PreyCat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I utilized <code>forage_beta</code> to generate predictions on the logit link scale for each combination of dive time and prey category in the prediction grid. I also calculated the standard errors of these predictions. I then used the predicted values and their standard errors to compute 95% confidence intervals on the link scale by adding and subtracting 1.96 times the standard error from the predicted values to obtain the lower and upper bounds.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on logit link scale with standard errors</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pred_link <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  forage_beta,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> predicted_data,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on logit link scale with standard errors</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>fit <span class="ot">&lt;-</span> pred_link<span class="sc">$</span>fit</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>se.fit <span class="ot">&lt;-</span> pred_link<span class="sc">$</span>se.fit</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate CIs on link scale for lower and upper bounds</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>lower_link <span class="ot">&lt;-</span> predicted_data<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> predicted_data<span class="sc">$</span>se.fit</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>upper_link <span class="ot">&lt;-</span> predicted_data<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> predicted_data<span class="sc">$</span>se.fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It was necessary to revert the predicted values and confidence intervals from the logit link scale back to the response scale, so I created an inverse logit function to perform this transformation. I then calculated the predicted proportions as well as the lower and upper bounds of the 95% confidence intervals using the inverse logit function <code>inv_logit</code>. Finally, I filtered the prediction grid to focus only on the prey categories of interest, clams and urchins, for data visualization.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Revert to response scale usinng inverse logit</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run inverse function on lower and upper bounds, as well as predicted adjusted prop uneaten</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>predicted_PropNotEat_adj <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(predicted_data<span class="sc">$</span>fit)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(predicted_data<span class="sc">$</span>lower_link)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>predicted_data<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(predicted_data<span class="sc">$</span>upper_link)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only categories to plot </span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>predicted_ribbon <span class="ot">&lt;-</span> predicted_data <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PreyCat <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Clam"</span>, <span class="st">"Urchin"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fitted lines per prey category</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>predicted_data <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DT, <span class="at">y =</span> predicted_PropNotEat_adj, <span class="at">color =</span> PreyCat)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Dive Time on Predicted Proportion Not Eaten Based on Prey Category"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dive Time (seconds)"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Proportion Not Eaten"</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_draft_copy_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fitted lines per prey category (faceted view)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>predicted_data <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DT, <span class="at">y =</span> predicted_PropNotEat_adj, <span class="at">color =</span> PreyCat)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Dive Time on Predicted Proportion Not Eaten Based on Prey Category"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dive Time (seconds)"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Proportion Not Eaten"</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> PreyCat) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_draft_copy_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With a faceted view, it is observable that as dive time increases, the proportion of prey left uneaten generally decreases for all prey types. Clams consistently have the highest predicted proportion left uneaten across dive times, while sea cucumbers show the lowest. Starfish and urchins also have similar predicted proportions, being slightly lower than clams but higher than sea cucumbers.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ribbon</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>predicted_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(PreyCat <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Clam"</span>, <span class="st">"Urchin"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DT, <span class="at">y =</span> predicted_PropNotEat_adj, <span class="at">color =</span> PreyCat)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ribbon for Clam and Urchin</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> predicted_ribbon,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, <span class="at">fill =</span> PreyCat),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predicted lines for all categories</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Dive Time on Predicted Proportion Not Eaten by Prey Category"</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dive Time (seconds)"</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Proportion Not Eaten"</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_draft_copy_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The predicted proportion of prey left uneaten for clams and urchins across dive times is visualized above, including 95% confidence intervals for predicted outcomes. As dive time increases, the proportion of prey left uneaten decreases for both prey types. Clams have a higher predicted proportion left uneaten than urchins across the range of five times. Additionally the ribbons illustrate the uncertainty around these predictions, with urchins indicating a wider confidence interval and potentially more variability in predicted values compared to clams.</p>
<p>At approximately the halfway point of 125 seconds of diving, it can be stated with 95% confidence that sea otters leave about 57% of a clam uneaten on average, compared to 49% of an urchin. This suggests that sea otters may expend more energy processing sea urchins than clams, and as a result, they may leave less uneaten when spending more time diving.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The purpose of this analysis was to demonstrate how a statistical model, specifically beta regression, can be used to perform meaningful analyses, including hypothesis testing and interpreting confidence intervals. The analysis indicates that sea otters tend to leave more of their prey uneaten as dive time increases, reflecting the statistically significant effect of dive duration on the proportion of prey not consumed. Prey category does not appear to influence the proportion of urchins left uneaten. However, sea otters are generally more wasteful with sea cucumbers than with clams, suggesting that clams are a highly valued prey item. Interestingly, sea otters leave a higher proportion of clams uneaten than urchins as dive time increases. For example, at around 125 seconds of diving, it is estimated with 95% confidence that about 57% of a clam remains uneaten on average, compared to 49% of an urchin.</p>
<p>For future analysis, the age (adult and juvenile) of observed sea otters may be considered as a potential confounding variable impacting diving time, preference for prey, and the proportion of prey left uneaten. Including age could be beneficial to clarify whether observed patterns in prey consumption are consistent across different life stages of if younger and older otters exhibit distinct foraging behaviors. Moreover, experience and physical capability could be accounted for in terms of impacts on feeding efficiency.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Cribari-Neto, F. (n.d.). <em>Beta regression in R</em>. Retrieved December 11, 2025, from https://cran.r-project.org/web/packages/betareg/vignettes/betareg.html</p>
<p>LaRoche, N., King, S., &amp; Pearson, H. (2020). <em>Sea otter foraging data, visual observations from Prince of Wales, Alaska</em>. [Dataset]. Knowledge Network for Biocomplexity. Retrieved October 5, 2025, from</p>
<p><a href="https://knb.ecoinformatics.org/view/doi%3A10.5063%2FF1C53J8X" class="uri">https://knb.ecoinformatics.org/view/doi%3A10.5063%2FF1C53J8X</a>&nbsp;</p>
<p>LaRoche, N., King, S., Fergusson, E., Eckert, G., &amp; Pearson, H. (2023). <em>Sea otter diet nutrient composition with respect to recolonization, life history, and season in southern Southeast Alaska</em>. Wiley. <a href="https://doi.org/10.22541/au.167222186.60136269/v1" class="uri">https://doi.org/10.22541/au.167222186.60136269/v1</a></p>
<p><em>R: The beta distribution in regression parameterization</em>. (n.d.). Retrieved December 11, 2025, from https://search.r-project.org/CRAN/refmans/betareg/html/dbetar.html?utm_source</p>
<p>Smithson, M., &amp; Verkuilen, J. (2006). <em>A better lemon squeezer? Maximum-likelihood regression with beta-distributed dependent variables</em>. <em>Psychological Methods</em>, <em>11</em>(1), 54–71. https://doi.org/10.1037/1082-989x.11.1.54</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2025, Vedika Shirtekar</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>