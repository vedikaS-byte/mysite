{
  "hash": "980cf1e71151e670076dac7a5adf3c63",
  "result": {
    "markdown": "---\ntitle: \"\"\nauthor: \"\" \ndate: \"12/6/2025\"\nformat:\n  html: \n    code-fold: true\neditor: \n  markdown: \n    wrap: 72\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Ocean Superfarms: Finding the Best Spots to Grow Seafood\n\n## **Purpose**\n\n**GitHub Repository Link:**\n<https://github.com/vedikaS-byte/suitability-aquaculture-analysis>\n\nThere is a growing global need to sustainably feed expanding human\npopulations, and one promising solution is marine aquaculture.\nAquaculture is defined as the organized cultivation, feeding,\npropagation, and production of aquatic organisms for commercial,\nrecreational, or public use (Alleway et al., 2018). The aquaculture\nindustry has significant potential to support food security while also\ncontributing to conservation and economic development. In California,\naquaculture is highly diverse in its production systems, cultured\nspecies, and final products, accounting for approximately 6% of the\ntotal value of the U.S. aquaculture industry (Wright et al., 2025).\nWright et al. identify four main sectors within California aquaculture:\nfinfish, shellfish, algae, and natural resource agencies. Finfish and\nshellfish production together represent more than 70% of the industry’s\ntotal value and primarily supply food for human consumption (Wright et\nal., 2025). As a result, commercial aquaculture has become an\nincreasingly important and profitable source of marine food production\nin California.\n\n![**Figure 1. Kelp forest pictured in Channel Islands National Park\n([The Nature\nConservancy](https://blog.nature.org/2019/01/21/aquaculture-could-be-conservations-secret-weapon/)).**](images/kelp_forest.png)\n\nOysters and the critically endangered red abalone are two commercially\nsignificant species in California aquaculture. Oysters represent the\nlargest share of mollusk aquaculture production in the state, followed\nby abalone, mussels, and marine clams, which together comprise the\nremainder of California’s mollusk industry output (Wright et al., 2025).\nAlthough oysters are relatively sturdy animals, they are sensitive to\nenvironmental conditions and are typically confined to sea surface\ntemperatures (SSTs) between 11-30°C and water depths ranging from 0-70\nmeters below sea level (Oliver, 2025). The critically endangered red\nabalone (*Haliotis rufescens*), a marine gastropod, thrives in cooler\nSSTs of 8-18°C and is generally limited to depths of 0-25 meters below\nsea level (SeaBase, n.d.).\n\nBoth oysters and red abalone are known to inhabit waters along the U.S.\nWest Coast. The West Coast includes multiple Exclusive Economic Zones\n(EEZs), ocean areas extending roughly 230 miles beyond a nation’s\nterritorial sea and where a coastal nation has jurisdiction over both\nbiotic and abiotic resources (NOAA, 2023). As such, identifying regions\nwhere their suitable environmental ranges overlap within Exclusive\nEconomic Zones (EEZs) may help evaluate potential areas for sustainable\nand profitable aquaculture development.\n\n![**Figure 2. The critically endangered and commercially significant red\nabalone ([California Conservation Genomics\nProject](https://www.ccgproject.org/species/haliotis-rufescens-red-abalone)).**](images/clipboard-2766546493.png)\n\nThe purpose of this blog post is to evaluate the suitability of West\nCoast Exclusive Economic Zones (EEZs) for developing marine aquaculture\nfor multiple oyster species and the red abalone. Suitable locations are\nidentified using species-specific ranges of sea surface temperature\n(SST) and ocean depth. This project utilizes GIS applications such as\nworking with vector and raster data, raster resampling, masking, and map\nalgebra to analyze environmental conditions. The analysis includes two\nmain components: (1) creating a final map of suitable oyster aquaculture\nareas, and (2) building a function that allows users to generate\nsuitability maps by EEZ based on selected species, temperature ranges,\nand depth limits. The following research question was utilized to\nfacilitate the analysis:\n\n**How do changes in species-specific temperature and depth thresholds\naffect the identification of suitable aquaculture areas within West\nCoast Exclusive Economic Zones (EEZs) for commercially significant\nmarine species?**\n\n## Data Description\n\nThe Bren School of Environmental Science and Management at the\nUniversity of California, Santa Barbara provided essential support for\nthis project, including access to data resources, documentation, and\ntechnical guidance.\n\n[SeaLifeBase](https://www.sealifebase.ca/search.php) is a publicly\navailable online database that provides information on a wide range of\nmarine species based on criteria such as commercial importance and\ntaxonomic group. Each species profile includes details on depth range,\ntemperature preference, geographic distribution, life history, and\nclassification. The database is open access and does not require any\ndownloads to use.\n\nFor this analysis, West Coast Exclusive Economic Zone (EEZ) boundaries\nwere obtained from [Marineregions.org](https://marineregions.org/) to\ndefine maritime boundaries. The [General Bathymetric Chart of the Oceans\n(GEBCO)](https://www.gebco.net/data_and_products/gridded_bathymetry_data/#area)\nis a global terrain model that provides geospatial information, such as\nelevation, for both ocean and land surfaces at a 15-arc-second grid\nresolution (GEBCO, n.d.). Bathymetry data for this analysis were\ndownloaded from GEBCO as a `tif` file. This analysis also used\nsatellite-derived average sea surface temperature (SST) data from\n2008–2012 to characterize mean SST within each EEZ. Although the GeoTIFF\nfiles were provided through course materials, the original data are\npublicly available from [NOAA’s 5 km Daily Global Satellite Sea Surface\nTemperature Anomaly v3.1\nproduct](https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php).\n\n## **Part 1: Map of Suitable Locations for Oyster Aquaculture**\n\n### **Data Preparation**\n\nBefore beginning my analysis, I loaded the appropriate packages to\nproperly read, manipulate, and work with geospatial data in formats such\nas `sf`, `SpatRaster`, and `SpatVector`. I used the `vect()` function to\nread in the West Coast EEZ shapefile as a vector layer. I imported the\nbathymetry dataset using the `rast()` function and stored it as a\n`SpatRaster` object. For the sea surface temperature (SST) data, I\nidentified all `.tif` files using `list.files()` and combined them into\na single raster stack with `rast()` for further analysis. I also\nincluded a conditional check that stops the code if `character(0)` is\nreturned, indicating that no raster files were found in the directory\nand that an absolute file path should be specified.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Import packages\nlibrary(here) # Load \"here\" to locate and reference files\nlibrary(tidyverse) # Load the tidyverse\" for data cleaning\nlibrary(sf) # Load \"sf\" for GIS analysis\nlibrary(raster) # Load \"raster\" for accessing raster data types\nlibrary(ggplot2) # Load \"ggplot2\" for data visualization\nlibrary(tmap) # Load \"tmap\" for functions to create and layer maps\nlibrary(kableExtra) # Load \"kableExtra\" for table formatting\nlibrary(stars) # Load \"stars\" for integration with \"sf\"\nlibrary(terra) # Load \"terra\" for SpatVector and SpatRaster operations\n# knitr::opts_knit$set(root.dir = here::here(\"posts\", \"aquaculture-post\"))\n# getwd()\n\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# West Coast EEZ\neez <- vect(here::here(\"posts\", \"aquaculture-post\", \"data_aqua\", \"wc_regions_clean.shp\"))\n\n# Bathymetry raster\ndepth <- rast(here::here(\"posts\", \"aquaculture-post\",\"data_aqua\", \"depth.tif\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list of the tiff files for SST\nsst_files <- list.files( # Define file path\n  path = \"/Users/vedikashirtekar/Documents/MEDS/mysite/posts/aquaculture-post/data_aqua\"\n,\n  # Pattern matches all tiff files starting with   \"average_annual\"\n  pattern = \"average_annual.*\\\\.tif$\",\n  full.names = T \n)\n\n\n# Stop running if character(0) returned\nif (length(sst_files) == 0) {\n  stop(\"No SST raster files found in directory.\")\n}\n\n# Stack raster files\nsst <- rast(sst_files)\n```\n:::\n\n\nIt is critical to ensure that the coordinate reference system (CRS) of\nall geospatial objects match to avoid misalignment, inaccurate\nmeasurements, and errors during spatial analysis. Here, I used\nconditional statements with `st_crs()` to detect and resolve any CRS\nmismatches between spatial objects and to display a message when\nmismatches were found.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create list of spatial objects\nspatial_objects <- list(eez, depth, sst)\n\n# Use eez's CRS as reference\nref_crs <- st_crs(spatial_objects$eez)\n\n# Check and transform each tile with if/else statements\nif (st_crs(spatial_objects$depth) != ref_crs) {\n  warning(\"depth CRS does not match. \n          Transforming to match eez CRS.\")\n  spatial_objects$depth <- st_transform(spatial_objects$depth, ref_crs)\n} else {\n  message(\"depth CRS already matches eez CRS.\")\n}\n## depth CRS already matches eez CRS.\n\nif (st_crs(spatial_objects$sst) != ref_crs) {\n  warning(\"sst CRS does not match. \n          Transforming to match eez CRS.\")\n  spatial_objects$sst <- st_transform(spatial_objects$sst, ref_crs)\n} else {\n  message(\"sst CRS already matches eez CRS.\")\n}\n## sst CRS already matches eez CRS.\n```\n:::\n\n\n### **Data Processing**\n\nBefore combining the SST and depth data, it was necessary to conduct\nseveral preprocessing steps to ensure accurate spatial alignment and\nanalysis. I first projected the depth dataset to match the SST CRS to\nensure proper spatial alignment. Then, I created a single raster\nrepresenting average SST from 2008–2012 using the `mean()` function and\nconverted the average temperature from Kelvin to Celsius by globally\nsubtracting 273.15 K from all raster values. To prepare the datasets for\nanalysis, I ensured both rasters matched in terms of a shared CRS,\nresolution, and extent. Then, I cropped and resampled (`resample()`) the\ndepth raster to the SST boundary to match the resolution of the average\nSST raster using the nearest neighbor method.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reproject to match sst CRS\ndepth <- project(depth, sst)\n\n# Calculate average SST among all rasters\navg_sst <- mean(sst)\n\n# Update avg_sst in degrees Celsius\navg_sst <- avg_sst - 273.15\n\n# Do the CRS match?\nmessage(\"Do the CRS match:\", crs(avg_sst) == crs(depth))\n## Do the CRS match:TRUE\n\n# Do the resolutions match (require resampling)? \nmessage(\"Do the resolutions match:\", res(avg_sst) == res(depth))\n## Do the resolutions match:TRUETRUE\n\n# Do the extents match?\nmessage(\"Do the extents match: \", ext(avg_sst) == ext(depth))\n## Do the extents match: TRUE\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use crop() to crop depth to the extent of avg_sst\ndepth_sst_crop <- crop(depth, avg_sst)\n\n# Resample with nearest neighbor method\ndepth_sst_crop <- resample(depth_sst_crop, avg_sst, method = \"near\")\n```\n:::\n\n\n### **Finding Suitable Locations**\n\nTo identify suitable aquaculture locations, I reclassified the average\nSST and depth rasters using oyster-specific temperature and depth\nthresholds in `classify()`, where suitable values were assigned a value\nof 1 and unsuitable values a value of 0. I then defined a function to\ncombine both layers by multiplying the reclassified rasters to identify\nareas that met both environmental requirements. Finally, I stacked the\nreclassified SST and depth layers using `lapp()` and applied the\nfunction to generate a single binary raster showing overall suitability.\nThe output raster `avg_sst_depth` is a `SpatRaster` with binary values\nof 0 and 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Preferred oyster range for SST: 11-30°C\n\n# Define reclass matrix for un/suitable SST\nreclass_matrix_sst <- matrix(\n  c(-Inf, 11, 0, # Negative infinity (unbounded) to 11 degrees assigned 0\n    11, 30, 1, # 11-30 degrees assigned 1\n    30, Inf, 0), # 30 to infinity (unbounded) assigned 0\n  ncol = 3, # Create three columns\n  byrow = T # Fill by row \n)\n\n# Assign reclassified values to avg_sst\navg_sst_reclass <- classify(avg_sst, rcl = reclass_matrix_sst)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Preferred oyster range for depth: 0-70 meters below sea level\n\n# Define reclass matrix for un/suitable depth\nreclass_matrix_depth <- matrix(\n  c(-Inf, -70, 0, # -70 used for values below sea level\n    -70, 0, 1, # Suitable values assigned 1 for -70-0\n    0, Inf, 0), # > 0 assigned unsuitable (0)\n  ncol = 3,# Create three columns\n  byrow = T # Fill by row  \n)\n\n# Assign reclassified values to depth\ndepth_reclass <- classify(depth_sst_crop, rcl = reclass_matrix_depth)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create multiplication function to reference in lapp\nmultiply <- function(x,y){ \n  multi_raster <- x*y # Raster multiplication across all cells\n  return(multi_raster)\n  }\n\n# Return suitable (1) and unsuitable (0) cells \navg_sst_depth <- lapp(\n  x = c(avg_sst_reclass,depth_reclass), # Stack rasters\n  fun = multiply) # Apply multiplication function \n\n# Print binary raster \navg_sst_depth\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatRaster \nsize        : 480, 408, 1  (nrow, ncol, nlyr)\nresolution  : 0.04166185, 0.04165702  (x, y)\nextent      : -131.9848, -114.9867, 29.99305, 49.98842  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 \nsource(s)   : memory\nname        : lyr1 \nmin value   :    0 \nmax value   :    1 \n```\n:::\n:::\n\n\n### **Determining the Most Suitable EEZ**\n\nIn order to rank EEZ zones by aquaculture potential, it was important to\ndetermine the total suitable area within each EEZ. I calculated the\ntotal suitable area within each zone, then projected the EEZ shapefile\nto match the CRS of the suitability raster (`avg_sst_depth`). I then\nutilized the `ifel()` function to identify suitable cells within the\nEEZs by reclassifying values of 0 as `NA` (unsuitable) and converting\nall remaining values to 1 (suitable), allowing only viable areas to be\nincluded in the following calculations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Project\neez <- project(eez, avg_sst_depth)\n\n# Select suitable areas\navg_sst_depth_suitable <- ifel(avg_sst_depth == 0, \n                               NA, # Replace with NA\n                               1) # Otherwise assign \"1\"\n```\n:::\n\n\nNext, I calculated the total suitable aquaculture area (km²) within each\nEEZ by masking, calculating cell area, and summarizing suitability by\nregion. It was necessary to rasterize the `eez` `SpatVector` because\nvector EEZ polygons must be represented in raster space to allow area\nsummarization per region using raster-based functions. I utilized\n`rasterize()` to convert the EEZ polygons so that each raster cell was\nlabeled by region, enabling area calculations with zonal statistics.\nAdditionally, I created a mask to include only raster values within the\nEEZ regions, excluding any areas outside these boundaries. The resulting\nraster contained the surface area of each cell, calculated using\n`cellSize()`. Finally, I used `zonal()` to sum the area of suitable\ncells for each EEZ and joined the results back to the spatial reference\ndataset (`eez_sf`) to visualize the distribution of suitable aquaculture\nareas using `tmap`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rasterize eez regions\neez_rast <- rasterize(eez, avg_sst_depth_suitable, \n                      field = \"rgn\") # By region\n# Identify suitable cells in mask \nsuitable_cells_eez <-  mask(avg_sst_depth_suitable, eez)\n\n# Calculate cell areas (km^2)\ncell_area <- cellSize(suitable_cells_eez, unit = \"km\")\n\n# Convert to sf object\neez_sf <- st_as_sf(eez) # To have geometry\n\narea_eez <- zonal(cell_area * suitable_cells_eez, # Identify area of suitable locations \n                  eez_rast, # Rasterized eez\n                  fun = \"sum\", na.rm = T) %>%  # Sum areas of cells within each EEZ zone \n  rename(suitable_area_km2 = area) %>% # Rename for naming conventions\n  as.data.frame() %>% # Convert to data frame\n  left_join(eez_sf, by = \"rgn\") # Join on region\n\n# Convert back into sf so eez data (includes calculated suitable area) for mapping\narea_eez <- area_eez %>% st_as_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create map\noyster_pref_map <- tm_shape(area_eez) +\n  tm_polygons(\n    \"suitable_area_km2\", # Color by suitable_area_km2 variable\n    palette = \"-mako\", # Reverse blue scale\n    style = \"cont\", # Continuous scale (styles referenced:\n    #https://r-tmap.github.io/tmap-book/visual-variables.html)\n    title = expression(\n      \"Suitable Area\"~\"(\"~ km^2~\")\") # Rename legend title\n  ) +  \n  \n  tm_text(\"rgn\", # Label by region\n          size = .65, # Adjust size\n          col = \"white\", # Adjust text color\n          fontface = \"bold\",  # Labels are bolded\n          xmod = -.5) + # Adjust .5 from the left\n  \n  tm_layout( # Center title outside bounding box\n    main.title = \"Marine Aquaculture Suitability for Oysters in West Coast EEZs\",\n     main.title.size = 1.5, # Adjust title size\n    legend.outside = TRUE, # Place legend outside map frame\n    legend.outside.position = \"right\", # Place legend to right\n    component.autoscale = FALSE, # Disable autoscaling for title\n    outer.margins = c(0.01, 0.25, 0.01, 0.05) # Manually adjust map frame\n    ) + \n  \n   tm_scale_bar( # Add scale bar for scale\n     position = c(-.01, 0.08),   # Move 1% from left and 8% from bottom \n     breaks = seq(0, 500, 150)) + # Establish scale bar ranges\n\n     tm_compass( # Add compass for orientation\n     type = \"4star\",        \n     position = c(\"right\", \"top\")) + # Adjust position\n  tm_basemap(\"Esri.OceanBasemap\") # Ocean basemap\n\n# Save finalized map to figs\ntmap_save(oyster_pref_map, filename = \"images/oyster_pref_map.png\", width = 8, height = 6)\n```\n:::\n\n\n![](images/oyster_pref_map.png){width=\"2500\"} **Map 1. Finalized map of\nsuitable aquaculture areas within West Coast EEZs for oysters.**\n\nThe suitable area for oyster harvesting relative to the total area of\neach EEZ region was also examined. I created a table using `kableExtra`\nto display both the total suitable area and the proportion of each EEZ\nthat is suitable for oyster aquaculture, allowing for comparisons across\nregions independent of EEZ size.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Table with kableextra for prop of suitable areas to EEZ area\narea_eez %>%\n  st_drop_geometry %>%  # Drop geometry\n  dplyr::select(region = rgn, # Select region\n         suitable_area_km2, # Select suitable area\n         total_area_km2 = area_km2 # Rename to total_area\n         ) %>%   \n  # Update suitable_area to be rounded to nearest hundreth\n  mutate(suitable_area_km2 = round(suitable_area_km2, 2), \n         # Create new variable for prop of suitable area to total EEZ area\n         percent_suitable = round((suitable_area_km2 / total_area_km2) * 100, \n                                  1)) %>% # Round to nearest tenth\n  \n  dplyr::select(-total_area_km2) %>% # Deselect total_area\n  \n  # Rename columns\n  rename(\n    \"Region\" = region,\n     \"Suitable Area (km^2)\" = suitable_area_km2, \n    \"Proportion of Suitable Area in EEZ\" = percent_suitable\n    )  %>%\n\n  # Enable title\n  kable(caption = \"Amount of Suitable Areas by EEZ for Oyster Preferences\") %>% \n  # Allow table to be striped with highlight option\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                full_width = FALSE, # Disable full width \n                position = \"center\")  # Center labels\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Amount of Suitable Areas by EEZ for Oyster Preferences</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:right;\"> Suitable Area (km^2) </th>\n   <th style=\"text-align:right;\"> Proportion of Suitable Area in EEZ </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Central California </td>\n   <td style=\"text-align:right;\"> 3656.82 </td>\n   <td style=\"text-align:right;\"> 1.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern California </td>\n   <td style=\"text-align:right;\"> 194.13 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oregon </td>\n   <td style=\"text-align:right;\"> 1028.90 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern California </td>\n   <td style=\"text-align:right;\"> 3062.20 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Washington </td>\n   <td style=\"text-align:right;\"> 2435.93 </td>\n   <td style=\"text-align:right;\"> 3.6 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## **Part 2: Generalized Function of Aquaculture for Species Preferences**\n\nThe workflow observed in Part 1 is applicable to any species of interest\nto generate maps of suitable aquaculture areas within West Coast EEZs\nbased on species-specific temperature and depth ranges. To make this\nprocess reproducible, I created the `species_preference` function to\nstreamline identification of suitable zones for any species. The\nfunction takes minimum and maximum SST values, minimum and maximum depth\nlimits, and a species name as inputs, and returns a map of EEZ regions\nshaded by total suitable area.\n\nIt is important to note that `species_preference` performs calculations\nonly based on the specific inputs provided, such as reclassification and\naverage SST conversion. Therefore, I reloaded all spatial objects and\nverified that they shared the same CRS to ensure they were correctly\nprepared for processing within the function.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load in data again\n\n# West Coast EEZ\neez <- vect(here::here(\"posts\", \"aquaculture-post\", \"data_aqua\", \"wc_regions_clean.shp\"))\n\n# Bathymetry raster\ndepth <- rast(here::here(\"posts\", \"aquaculture-post\",\"data_aqua\", \"depth.tif\"))\n\n# Create a list of the tiff files for SST\nsst_files <- list.files( # Define file path\n  path = \"/Users/vedikashirtekar/Documents/MEDS/mysite/posts/aquaculture-post/data_aqua\"\n,\n  # Pattern matches all tiff files starting with   \"average_annual\"\n  pattern = \"average_annual.*\\\\.tif$\",\n  full.names = T \n)\n\n\n# Stop running if character(0) returned\nif (length(sst_files) == 0) {\n  stop(\"No SST raster files found in directory.\")\n}\n\n# Stack raster files\nsst <- rast(sst_files)\n\n\n\n# Create list of spatial objects\nspatial_objects <- list(eez, depth, sst)\n\n# Use eez's CRS as reference\nref_crs <- st_crs(spatial_objects$eez)\n\n# Check and transform each tile with if/else statements\nif (st_crs(spatial_objects$depth) != ref_crs) {\n  warning(\"depth CRS does not match. Transforming to match eez CRS.\")\n  spatial_objects$depth <- st_transform(spatial_objects$depth, ref_crs)\n} else {\n  message(\"depth CRS already matches eez CRS.\")\n}\n\n\n# Check and transform each tile with if/else statements\nif (st_crs(spatial_objects$sst) != ref_crs) {\n  warning(\"sst CRS does not match. Transforming to match eez CRS.\")\n  spatial_objects$sst <- st_transform(spatial_objects$sst, ref_crs)\n} else {\n  message(\"sst CRS already matches eez CRS.\")\n}\n```\n:::\n\n\nI also redefined the `multiply` function to support raster\nmultiplication within the `species_preference` function when used with\n`lapp()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define multiply function for global raster multiplication\nmultiply <- function(x,y){ \n  multi_raster <- x*y\n  return(multi_raster)\n  }\n```\n:::\n\n\nThe following code cells demonstrate the integrated workflow used in the\n`species_preference` function to generate a map of suitable aquaculture\nareas within West Coast EEZs based on species-specific SST and depth\nparameters. I applied the function using the temperature and depth\nranges for red abalone to produce a map analogous to the one for\nsuitable oyster aquaculture areas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# This function takes arguments:\n# minimum and maximum sea surface temperature\n# minimum and maximum depth\n# species name\n\nspecies_preference <- function(min_temp, max_temp, min_depth, max_depth, species_name){ \n\n### Assume files have been loaded in already with matching CRS checks\n  \n###____________________________________________________________\n### Data processing\n\n# Reproject to match sst CRS\ndepth <- project(depth, sst)\n\n# Calculate average SST among all rasters\navg_sst <- mean(sst)\n\n# Update avg_sst in degrees Celsius\navg_sst <- avg_sst - 273.15\n\n# Use crop() to crop depth to the extent of avg_sst\ndepth_sst_crop <- crop(depth, avg_sst)\n\n# Resample with nearest neighbor method\ndepth_sst_crop <- resample(depth_sst_crop, avg_sst, method = \"near\")\n\n###____________________________________________________________\n### Find suitable locations\n\n# Define reclass matrix for un/suitable SST\nreclass_matrix_sst <- matrix(\n  c(-Inf, min_temp, 0, # Negative infinity (unbounded) to min_temp\n    min_temp, max_temp, 1, # min-max temp assigned 1\n    max_temp, Inf, 0), # max_temp to infinity (unbounded) assigned 0\n  ncol = 3, # Create three columns\n  byrow = T # Fill by row \n)\n\n# Assign reclassified values to avg_sst\navg_sst_reclass <- classify(avg_sst, rcl = reclass_matrix_sst)\n\n# Define reclass matrix for un/suitable depth\nreclass_matrix_depth <- matrix(\n  c(-Inf, min_depth, 0, # Negative infinity (unbounded) to min_temp (below sea level)\n    min_depth, max_depth, 1, # min-max depth assigned 1\n    max_depth, Inf, 0), # > max_depth assigned unsuitable (0)\n  ncol = 3,# Create three columns\n  byrow = T # Fill by row  \n)\n\n# Assign reclassified values to depth\ndepth_reclass <- classify(depth_sst_crop, rcl = reclass_matrix_depth)\n\n# Return suitable (1) and unsuitable (0) cells \navg_sst_depth <- lapp(\n  x = c(avg_sst_reclass,depth_reclass), # Stack rasters\n  fun = multiply) # Apply multiplication function \n\n\n###____________________________________________________________\n### Determine most suitable locations within EEZs\n\n# Project\neez <- project(eez, avg_sst_depth)\n\n# Select suitable areas\navg_sst_depth_suitable <- ifel(avg_sst_depth == 0, \n                               NA, # Replace with NA\n                               1) # Otherwise assign \"1\"\n\n# Rasterize eez regions\neez_rast <- rasterize(eez, avg_sst_depth_suitable, \n                      field = \"rgn\") # By region\n\n# Identify suitable cells in mask \nsuitable_cells_eez <-  mask(avg_sst_depth_suitable, eez)\n\n# Calculate cell areas (km^2)\ncell_area <- cellSize(suitable_cells_eez, unit = \"km\")\n\n# Convert to sf object\neez_sf <- st_as_sf(eez) # To have geometry\n\narea_eez <- zonal(cell_area * suitable_cells_eez, # Identify area of suitable locations \n                  eez_rast, # Rasterized eez\n                  fun = \"sum\", na.rm = T) %>%  # Sum areas of cells within each EEZ zone \n  rename(suitable_area_km2 = area) %>% # Rename for naming conventions\n  as.data.frame() %>% # Convert to data frame\n  left_join(eez_sf, by = \"rgn\") # Join on region\n\n# Convert back into sf so eez data (includes calculated suitable area) for mapping\narea_eez <- area_eez %>% st_as_sf()\n\n###____________________________________________________________\n### Create map of suitable areas within EEZs\ntm_shape(area_eez) +\n  tm_polygons(\n    \"suitable_area_km2\", # Color by suitable_area_km2 variable\n    palette = \"-mako\", # Reverse blue scale\n    style = \"cont\", # Continuous scale \n    title = expression(\n      \"Suitable Area\"~\"(\"~ km^2~\")\") #Rename legend title\n  ) +  \n  tm_text(\"rgn\", # Label by region\n          size = .65, # Adjust size\n          col = \"white\", # Adjust text color\n          fontface = \"bold\",  # Labels are bolded\n          xmod = -.5) + # Adjust .5 from the left\n  \n  tm_layout( # Center title outside bounding box\n    main.title = paste(\"Marine Aquaculture Suitability for\",\n                        species_name, # Include species name in title\n                       \"in West Coast EEZs\"),\n     main.title.size = 1.5, # Adjust title size\n    legend.outside = TRUE, # Place legend outside map frame\n    legend.outside.position = \"right\", # Place legend to right\n    component.autoscale = FALSE, # Disable autoscaling for title\n    outer.margins = c(0.01, 0.25, 0.01, 0.05) # Manually adjust map frame\n    ) + \n  \n   tm_scale_bar( # Add scale bar for scale\n     position = c(-.01, 0.08),   # Move 1% from left and 8% from bottom \n     breaks = seq(0, 500, 150)) + # Establish scale bar ranges\n\n     tm_compass( # Add compass for orientation\n     type = \"4star\",        \n     position = c(\"right\", \"top\")) + # Adjust position\n  tm_basemap(\"Esri.OceanBasemap\") # Ocean basemap\n}\n\n# Output:\n# Map of EEZ regions colored by amount of suitable area\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Call function for Red Abalone and preferred temp/depth range\nspecies_pref_map <- species_preference(min_temp = 8, \n                                       max_temp = 18, \n                                       min_depth = -25, \n                                       max_depth = 0, \n                                       species_name = \"Red Abalone\")\n\n# Save finalized map to figs\ntmap_save(species_pref_map, filename = \"images/species_pref_map.png\", width = 8, height = 6)\n```\n:::\n\n\n![](images/species_pref_map.png){width=\"1000\"} **Map 2. Finalized map of\nsuitable aquaculture areas within West Coast EEZs for red abalone.**\n\n## Reflection\n\nFor oysters species along the West Coast, Central California is the most\nsuitable EEZ with about 3,656.82 km^2^ of suitable area while Northern\nCalifornia is the least suitable EEZ with about 194.13 km^2^ of suitable\narea. Central California likely offers the most favorable SST and depth\nconditions for oyster cultivation. Notably, the Washington EEZ has a\nlarger suitable area (1,028.90 km²) than Northern California despite its\ncolder location, indicating a higher proportion of habitat appropriate\nfor mollusk aquaculture. Central and Southern California also show\nrelatively high suitability. Oregon’s EEZ contains substantial suitable\narea as well, though less than most other regions.\n\nThe red abalone, a critically endangered marine gastropod, is a\ncommercially valuable species with strong potential for aquaculture. The\nWashington EEZ appears especially promising for red abalone cultivation,\nwith more than 1,500 km² of suitable area, likely due to the colder\nwater temperatures preferred by the species. Interestingly, Central and\nSouthern California also contain substantial suitable areas that exceed\nthose of Northern California, despite being further south and having\ngenerally warmer conditions; differences in coastal upwelling and\nnutrient availability may explain this pattern. Red abalone aquaculture\nalso represents a model for sustainable seafood production. For\ninstance, the Monterrey Abalone Company in Central California raises\nabalone in both marine and land-based systems with minimal use of\nchemicals and antibiotics (Bailey, 2015). Overall, red abalone farms\nhighlight opportunities for environmentally responsible aquaculture\nwhile supporting production in the most suitable West Coast EEZs,\nparticularly in Washington, Central California, and Northern California.\n\nSeveral considerations exist for future analysis. The analysis considers\nthe average annual SST and depth, but does not account for seasonal\nvariation that may influence species suitability. Additionally, the\n`species_preference` function considers only temperature and depth\nranges; other ecological or biological factors (ex. salinity and\npredation) are not included and are thus simplified. The accruacy of the\nEEZ polygons are important as they affect results. For example,\nmisaligned or outdated boundaries could mislead researchers into\nincorrect area calculations. Therefore, an improved analysis would\nincorporate flexibility for complex species preferences to avoid\noversimplification and ensure that geospatial objects are properly\naligned, yielding more accurate results.\n\n## References\n\n\\[1\\] Alleway, H. K., Gillies, C. L., Bishop, M. J., Gentry, R. R.,\nTheuerkauf, S. J., & Jones, R. (2018). *The ecosystem services of marine\naquaculture: Valuing benefits to people and nature*. BioScience, 69(1),\n59–68. <https://doi.org/10.1093/biosci/biy137>\n\n\\[2\\] California Conservation Genomics Project. (n.d.). *Haliotis\nrufescens (Red Abalone)*. Retrieved November 29, 2025, from\n<https://www.ccgproject.org/species/haliotis-rufescens-red-abalone>\n\n\\[3\\] *Gridded bathymetry data*. (n.d.). GEBCO. Retrieved November 30,\n2025, from\n<https://www.gebco.net/data-products/gridded-bathymetry-data#area>\n\n\\[4\\] *Haliotis rufescens, Red abalone: Fisheries.* (n.d.). Retrieved\nNovember 30, 2025, from\n<https://www.sealifebase.ca/summary/Haliotis-rufescens.html>\n\n\\[5\\] Hausheer, J. E. (2023). *Aquaculture Could Be Conservation’s\nSecret Weapon.* The Nature Conservancy. Retrieved November 29, 2025,\nfrom\n<https://blog.nature.org/2019/01/21/aquaculture-could-be-conservations-secret-weapon/>\n\n\\[6\\] *Marine regions.* (n.d.). Retrieved November 28, 2025, from\n<https://www.marineregions.org/eez.php>\n\n\\[7\\] *Monterey Bay Abalone farm shows what sustainable aquaculture can\nbe like.* (n.d.). Earth Island Journal. Retrieved November 29, 2025,\nfrom\n<https://www.earthisland.org/journal/index.php/articles/entry/monterey_bay_abalone_farm_shows_what_sustainable_aquaculture_can_be_like/>\n\n\\[8\\] *NOAA coral reef watch daily 5km satellite coral bleaching heat\nstress SST anomaly product* (version 3.1). (n.d.). Retrieved November\n29, 2025, from\n<https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php>\n\n\\[9\\] Oliver, R. (2025). *Homework assignment 4.* Retrieved November 28,\n2025, from\n<https://eds-223-geospatial.github.io/assignments/HW4.html#fnref1>\n\n\\[10\\] Wright, A., Moody, C., & Gross, J. (2025). *Composition of\nCalifornia’s aquaculture industry and surveying its disease challenges\nand management strategies.* Aquaculture Reports, 42, 102799. Retrieved\nNovember 29, 2025, from <https://doi.org/10.1016/j.aqrep.2025.102799>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}