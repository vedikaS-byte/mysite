{
  "hash": "c6eb03bc8034a78a020e965aa93688fc",
  "result": {
    "markdown": "---\ntitle: \"\"\nformat: html\n---\n\n\n# Assessing Sea Otter Feeding Habitats Based on Prey Type and Dive Depth\n\n## Purpose\n\nThe sea otter (*Enhydra lutris*) is a highly social marine mammal that plays a vital role as a keystone species in maintaining the health of kelp forest ecosystems by controlling sea urchin populations. Although sea otters are primary predators of sea urchins, their diet is diverse and includes a wide variety of prey types. For example, sea otters in Alaska are known to consume a wide range of prey, including clams, crabs, sea urchins, sea cucumbers, and snails (LaRoche et al., 2018). In recolonized areas of Southeast Alaska, clams are strongly selected despite their relatively low abundance, reflecting their high quality value. Similarly, sea urchins dominate diets primarily in rocky reef habitats where they are more abundant (LaRoche et al., 2018).\n\n![](images/clipboard-1982355787.png)\n\nThe proportion of prey not eaten provides a measure of foraging efficiency and prey handling success, reflecting both biological constraints and behavioral choices during feeding. Because of their important role as a keystone species, understanding their diet and foraging patterns is essential for assessing feeding preferences and food availability in conservation.\n\nThis blog post aims to present and discuss the results of a statistical regression analysis conducted on sea otter foraging data collected from visual observations in Prince of Wales, Alaska, by LaRoche et al. (2018). A beta regression using `glmmTMB` with a zero-adjustment was selected for the analysis in order to assess the proportion of prey not consumed by sea otters during summer 2018. The following question was utilized to guide the analysis:\n\n**How does prey categorization and dive depth predict the proportion of prey not eaten?**\n\nThe mean proportion not eaten was modeled using a Beta regression with a logit link, while a precision parameter (ϕ) captured the variability in proportions around the mean.\n\n$$\n\\text{PropNotEaten} \\sim \\text{Beta}(\\alpha, \\beta)\n$$\n\n$$\nlogit(\\mu_i)\n= \\beta_{0}\n+ \\beta_{diveTime} \n+ \\beta_{PreyCat\\_urchin} \n+ \\beta_{PreyCat\\_crab} \n+ \\beta_{PreCat\\_cucumber} \n+ \\beta_{PreCat\\_star}  \n$$\n\n-   **Hypothesis 1:**\n\n    -   H~0~: β~PreyCat_urchins~ = 0. Sea otters leave the same proportion of urchins uneaten as they do with clams; prey category does not influence the proportion of prey eaten.\n\n    -   H~A~: β~PreyCat_urchins~ ≠ 0. Sea otters leave a significantly different proportion of urchins uneaten compared to clams; prey category has a significant effect on the proportion of prey not eaten.\n\n-   **Hypothesis 2**:\n\n    -   H~0~: β~dive_time~ = 0. Dive time has no significant effect on the proportion of prey not eaten; the duration of a dive does not influence how much prey is not eaten.\n\n    -   H~A~: β~dive_time~ ≠ 0. Dive time does significantly affect the proportion of prey not eaten; longer or shorter dives are associated with a higher or lower proportion of prey left uneaten.\n\nThe categorical variable `PreyCat` represents the general prey categorization of a prey type. In particular, clams and urchins differ biologically in handling difficulty and energetic return. Urchins may require more processing and include defensive structures (spines), whereas clams require shell-breaking but offer concentrated soft tissue. These differences potentially influence the proportion of prey successfully consumed, indicating a direct causal effect of prey category on the proportion of prey not consumed\n\nAdditionally, prey category may influence dive duration (continuous numeric variable) because hunting, handling, and extracting different prey may require different levels of effort and time. Thus, prey category potentially influences dive time, which in turn affects the proportion of prey not eaten.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\n# Create a DAG using dagitty package... relate to each variable \nlibrary(dagitty)\ndag <- dagitty(\"dag { \n  PreyCat -> DT \n  DT -> PropNotEat\n  PreyCat -> PropNotEat\n}\")\n\nplot(dag) # Visualize DAG\n```\n\n::: {.cell-output-display}\n![](final_draft_copy_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n## Data Availability and Characteristics\n\n### Data Access\n\nThe data used in this project were obtained from the [KNB Data Repository](https://knb.ecoinformatics.org/view/doi%3A10.5063%2FF1C53J8X) and are based on the finalized foraging dataset \"Sea otter foraging data, visual observations from Prince of Wales, Alaska*”* compiled by Nicole LaRoche, Sydney King, and Heidi Pearson (2018). LaRoche et al. documented sea otter diets from May to August 2018 using visual observations conducted along the western coast of Prince of Wales Island, Alaska, at sites characterized by high otter densities. The finalized foraging dataset is publicly accessible as a CSV file through the KNB Data Repository.\n\n### Data Importation, Exploration, and Processing\n\nThe foraging dataset used in this project had been previously cleaned by the original authors. However, additional processing was required, including adjusting variables to appropriate ranges and removing missing values. Therefore, further preprocessing steps were necessary before conducting the analyses.\n\nHere, I loaded the necessary packages for the analysis and then imported the dataset by providing the correct file path to `read_csv()`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nlibrary(here) \nlibrary(tidyverse)\n# https://cran.r-project.org/web/packages/betareg/vignettes/betareg.html#sec-model\nlibrary(glmmTMB)\nlibrary(broom)         \nlibrary(broom.mixed) # for glmmTMB mixed model\nlibrary(kableExtra)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nset.seed(123) # For reproducibility\nforage <- read_csv(\"forage_final (1)_copy.csv\")\n```\n:::\n\n\nMissing values (NAs) were removed prior to analysis. I then selected only the variables required for modeling: prey category (`PreyCat`), dive time (`DT`), and proportion not eaten (`PropNotEat`). Column names were also updated for clarity. Additionally, I generated a summary table showing the number of observations within each prey category and verified that all `NAs` had been removed from the selected variables using `colSums()` in combination with `is.na()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select for just prey category and diving time\nforage <- forage %>% select(PreyCat, PropNotEat, DT)\n#forage <- forage %>% filter(age != \"U\")\nforage <- forage %>% drop_na() \n#forage <- forage %>% filter(PreyCat != \"PreyCatMussel\", PreyCat != \"PreyCatSnail\")\ntable(forage$PreyCat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n    Clam     Crab Cucumber     Star   Urchin \n     205       71       28        7       12 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check the colSums to ensure all NAs are dropped\ncolSums(is.na(forage)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   PreyCat PropNotEat         DT \n         0          0          0 \n```\n:::\n:::\n\n\nVisualizing the initial data distribution was also helpful. I opted to use a scatterplot to show the relationship between dive time (a continuous numeric variable) and the proportion of prey not eaten by prey category, along with a boxplot to display the distribution of uneaten prey within each category.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\n# Create a scatterplot of dive time related to the proportion of prey not eaten based on prey category\nforage %>% ggplot(aes(x = DT, y = PropNotEat, col = PreyCat)) + \n  geom_jitter()  +\n  theme_bw() +\n  labs(x = \"Diving Time (seconds)\", \n       y = \"Proportion of Prey Not Eaten\", \n       title = \"Proportion of Prey Not Consumed By Sea Otters Based on Diving Time and /nPrey Category\") + \n  theme(plot.title = element_text(size = 11, face = \"bold\"))\n```\n\n::: {.cell-output-display}\n![](final_draft_copy_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\n# Create boxplots to visualize the distribution of prey categories and proportion of prey not eaten\nforage %>% ggplot(aes(x = PreyCat, y = PropNotEat, fill = PreyCat)) + geom_boxplot() +\n  scale_fill_manual(values = c(\n    \"Clam\" = \"#1b9e77\",\n    \"Urchin\" = \"#d95f02\",\n    \"Crab\" = \"#7570b3\",\n    \"Cucumber\" = \"#66a61e\",\n    \"Star\" = \"#e6ab02\"\n  )) + theme_bw()\n```\n\n::: {.cell-output-display}\n![](final_draft_copy_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\nFrom the scatterplot, it appears that sea otters spending roughly 25-100 seconds on prey often leave around 50% or even 100% of clams and crabs uneaten, suggesting potentially wasteful behavior. Most prey left uneaten cluster around 50% for clams, crabs, and sea cucumbers, and between 25-175 seconds for sea urchins. Notably, longer prey handling times, which are associated with deeper dives, are linked to lower proportions of prey left uneaten, typically under 25-50%, especially for clams, urchins, and crabs. The boxplot shows that starfish have a higher median proportion left uneaten than other prey categories, while sea cucumbers have the lowest median. Sea urchins also tend to be left uneaten less often than clams.\n\n### Data Simulation Procedure\n\nBefore building a model using real world data, it is important to simulate data to ensure that the model performs as expected. In this case, I generated simulated data to evaluate model performance, assess parameter recovery, and verify that the fitted model behaves appropriately.\n\nAccording to the `betareg` CRAN project, a variable cannot take exact values of 0 or 1. Therefore, a zero-adjustment is required to slightly decrease values of 1 to just below 1 and slightly increase values of 0 to just above 0. To adjust the response variable `PropNotEat` to the corrected range, I applied the zero-adjustment formula from the `betareg` vignette : $y_{\\text{adj}} = \\frac{y \\cdot (n - 1) + 0.5}{n}$, where *n* is the sample size (Smithson and Verkuilen, 2006).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Beta does not take direct 0 and 1, so do adjustment to offset before 1 and after 0\nforage <- forage %>%\n  mutate(PropNotEat_adj = # Transformation to adjust (betareg cranr)\n           (PropNotEat * (nrow(.) - 1) + 0.5) / nrow(.))\n```\n:::\n\n\nI was particularly interested in whether an interaction existed between dive time and prey category. To determine the most appropriate model, I fitted each candidate model using `glmmTMB()` with a `beta_family()` and logit link. I then compared models using Akaike’s Information Criterion (AIC) to identify the lowest score. The model `PropNotEat_adj ~ DT + PreyCat` had the lowest (most negative) AIC, indicating the best balance between fit and simplicity. Therefore, this model was selected for further analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Original model\nforage_beta <- glmmTMB(\n  PropNotEat_adj ~ DT + PreyCat,\n  data = forage,\n  family = beta_family(link = \"logit\")\n)\n\n\n# Model with interaction between PreyCat and DT\nforage_interaction <- forage_org <- glmmTMB(\n  PropNotEat_adj ~ PreyCat * DT,\n  data = forage,\n  family = beta_family(link = \"logit\")\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compare models (lowest AIC) (Akaike's An Information Criterion for log-link)\nAIC(forage_beta, forage_interaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   df       AIC\nforage_beta         7 -21.95160\nforage_interaction 11 -14.69916\n```\n:::\n:::\n\n\nTo assess model performance and parameter recovery, I simulated 15,000 observations based on the original model coefficients. Dive time (DT) was drawn from a uniform distribution, and prey category (PreyCat) was randomly assigned.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Reset seed (redefined)\nset.seed(123)\n\n# Define simulated obs... with law of large numbers, larger sample size should get closer to actual predictors\nn_sim <- 15000\n\n# Define coefficients from original model\nbeta0 <- 0.738077 \nbeta_dive_time <- -0.004949 \nbeta_crab <- -0.265717\nbeta_cucumber <- -0.449131\nbeta_star <- -0.240470 \nbeta_urchin <-  -0.205423\nphi <- 1.72 # Precision\n\n## Simulate range for predictors\ndt <- runif(n_sim, 3, 255) # Range of dive time\n\n# Randomly generate PreyCat factors for simulated data... then for each level, sample with replacement to get vector of length n_sim\nPreyCat <- sample(c(\"Clam\",\"Crab\",\"Cucumber\",\"Star\",\"Urchin\"), n_sim, replace = TRUE)\n\n## Define linear predictor and logit equation\n# Assign coefficient to each PreyCat level\nprey_effect <- ifelse(PreyCat == \"Crab\", beta_crab,\n               ifelse(PreyCat == \"Cucumber\", beta_cucumber,\n               ifelse(PreyCat == \"Star\", beta_star,\n               ifelse(PreyCat == \"Urchin\", beta_urchin, \n               0)))) # Else assign clam (reference)\n```\n:::\n\n\nA linear predictor combining dive time and prey effects was calculated on the logit scale and transformed to the response scale. Each observation was then reparameterized into `alpha` and `beta` parameters (derived from the `betareg` CRAN project) for the beta distribution using the mean and precision. `PropNotEat_adj` values were simulated accordingly using `rbeta()`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nglm_eq <- beta0 + beta_dive_time * dt + prey_effect # Recall that prey_effect has the associated beta coefficient for each level\n\n# Convert linear predictor (logit scale) to  mean proportion on response scale\nmean_sim <- exp(glm_eq) / (1 + exp(glm_eq))\n\n# Reparameterize beta distribution parameters (derived from CRAN at (https://search.r-project.org/CRAN/refmans/betareg/html/dbetar.html)\nalpha <- mean_sim * phi\nbeta <- (1 - mean_sim) * phi\n\n# Simulate response variable from beta distribution using calculated alpha and beta \nPropNotEat_adj <- rbeta(n_sim, alpha, beta)\n```\n:::\n\n\nThe resulting dataset was fitted with `glmmTMB()` using a beta family and logit link to verify that the model could recover the original relationships.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create simulated data frame\nsimulated_forage <- data.frame(\n  PropNotEat_adj = PropNotEat_adj,\n  DT = dt,\n  PreyCat = factor(PreyCat, levels = c(\"Clam\",\"Crab\",\"Cucumber\",\"Star\",\"Urchin\"))\n)\n\n# Fit simulated model\nsim_model <- glmmTMB(\n  PropNotEat_adj ~ DT + PreyCat,\n  data = simulated_forage,\n  family = beta_family(link = \"logit\")\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Compare coefficients\n# Create tidy table with broom package\nsim_tidy <- tidy(sim_model) %>% \n  mutate(model = \"Simulated\")  # Add column to identify model\n\n# Create tidy table for original model coefficients\noriginal_tidy <- tidy(forage_beta) %>% \n  mutate(model = \"Original\")  # Add column to identify model\n\n# Combine into table for comparison\ncoef_comparison <- bind_rows(sim_tidy, original_tidy)\n\n# View table\ncoef_comparison\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 8\n   effect component term            estimate std.error statistic   p.value model\n   <chr>  <chr>     <chr>              <dbl>     <dbl>     <dbl>     <dbl> <chr>\n 1 fixed  cond      (Intercept)      0.741    0.0271      27.4   9.21e-165 Simu…\n 2 fixed  cond      DT              -0.00502  0.000132   -38.0   2.07e-316 Simu…\n 3 fixed  cond      PreyCatCrab     -0.220    0.0297      -7.39  1.48e- 13 Simu…\n 4 fixed  cond      PreyCatCucumber -0.437    0.0297     -14.7   5.80e- 49 Simu…\n 5 fixed  cond      PreyCatStar     -0.260    0.0297      -8.74  2.35e- 18 Simu…\n 6 fixed  cond      PreyCatUrchin   -0.230    0.0297      -7.76  8.64e- 15 Simu…\n 7 fixed  cond      (Intercept)      0.752    0.166        4.52  6.17e-  6 Orig…\n 8 fixed  cond      DT              -0.00504  0.00146     -3.44  5.85e-  4 Orig…\n 9 fixed  cond      PreyCatCrab     -0.204    0.160       -1.27  2.02e-  1 Orig…\n10 fixed  cond      PreyCatCucumber -0.494    0.233       -2.12  3.44e-  2 Orig…\n11 fixed  cond      PreyCatStar     -0.248    0.448       -0.554 5.79e-  1 Orig…\n12 fixed  cond      PreyCatUrchin   -0.207    0.340       -0.610 5.42e-  1 Orig…\n```\n:::\n:::\n\n\nHere, it is observable that the coefficients for each predictor in the simulated model closely match those from the original model fitted to the real data. This indicates that the beta regression is able to reliably recover the underlying parameter relationships.\n\n## Inference and Hypothesis Testing with Beta Regression\n\nBeta regression was specifically chosen for this analysis because the response variable, `PropNotEat_adj`, is proportional. Recall the definition of the beta distribution used in the model:\n\n$$\n\\text{PropNotEaten} \\sim \\text{Beta}(\\alpha, \\beta)\n$$$$\nlogit(\\mu_i)\n= \\beta_{0}\n+ \\beta_{diveTime} \n+ \\beta_{PreyCat\\_urchin} \n+ \\beta_{PreyCat\\_crab} \n+ \\beta_{PreyCat\\_cucumber} \n+ \\beta_{PreyCat\\_star}  $$\n\n###Hypothesis Testing Interpretation Here, I interpreted the model results to assess whether each hypothesis is supported.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create cleaned summary output table\ntidy(forage_beta) %>% \n  mutate(\n    estimate  = round(estimate, 2),\n    std.error = round(std.error, 2),\n    statistic = round(statistic, 2),\n    p.value = round(p.value, 3)    \n  ) %>%\n  select(term, estimate, std.error, statistic, p.value) %>%\n  kable() %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 4.52 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DT </td>\n   <td style=\"text-align:right;\"> -0.01 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> -3.44 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatCrab </td>\n   <td style=\"text-align:right;\"> -0.20 </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n   <td style=\"text-align:right;\"> -1.27 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatCucumber </td>\n   <td style=\"text-align:right;\"> -0.49 </td>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:right;\"> -2.12 </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatStar </td>\n   <td style=\"text-align:right;\"> -0.25 </td>\n   <td style=\"text-align:right;\"> 0.45 </td>\n   <td style=\"text-align:right;\"> -0.55 </td>\n   <td style=\"text-align:right;\"> 0.579 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatUrchin </td>\n   <td style=\"text-align:right;\"> -0.21 </td>\n   <td style=\"text-align:right;\"> 0.34 </td>\n   <td style=\"text-align:right;\"> -0.61 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Hypothesis 1\n\nBased on the model, the coefficient for urchins compared to clams was not statistically significant, and as a result, we fail to reject the null hypothesis that sea otters leave the same proportion of urchins\n\n-   **Hypothesis 1:**\n\n    -   H~0~: β~PreyCat_urchins~ = 0. Sea otters leave the same proportion of urchins uneaten as they do with clams; prey category does not influence the proportion of prey eaten.\n\n    -   H~A~: β~PreyCat_urchins~ ≠ 0. Sea otters leave a significantly different proportion of urchins uneaten compared to clams; prey category has a significant effect on the proportion of prey not eaten.\n\n-   **Hypothesis 2**:\n\n    -   H~0~: β~dive_time~ = 0. Dive time has no significant effect on the proportion of prey not eaten; the duration of a dive does not influence how much prey is not eaten.\n\n    -   H~A~: β~dive_time~ ≠ 0. Dive time does significantly affect the proportion of prey not eaten; longer or shorter dives are associated with a higher or lower proportion of prey left uneaten.\n\n### **Interpreting Model β Confidence Intervals**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Recall that \nci_forage <- confint(forage_beta)\n\n# Style with kableExtra\nci_forage %>% \n  kable() %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:right;\"> 2.5 % </th>\n   <th style=\"text-align:right;\"> 97.5 % </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.4259353 </td>\n   <td style=\"text-align:right;\"> 1.0780332 </td>\n   <td style=\"text-align:right;\"> 0.7519842 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DT </td>\n   <td style=\"text-align:right;\"> -0.0079078 </td>\n   <td style=\"text-align:right;\"> -0.0021660 </td>\n   <td style=\"text-align:right;\"> -0.0050369 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatCrab </td>\n   <td style=\"text-align:right;\"> -0.5188186 </td>\n   <td style=\"text-align:right;\"> 0.1099012 </td>\n   <td style=\"text-align:right;\"> -0.2044587 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatCucumber </td>\n   <td style=\"text-align:right;\"> -0.9512994 </td>\n   <td style=\"text-align:right;\"> -0.0362902 </td>\n   <td style=\"text-align:right;\"> -0.4937948 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatStar </td>\n   <td style=\"text-align:right;\"> -1.1253184 </td>\n   <td style=\"text-align:right;\"> 0.6290517 </td>\n   <td style=\"text-align:right;\"> -0.2481334 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PreyCatUrchin </td>\n   <td style=\"text-align:right;\"> -0.8728423 </td>\n   <td style=\"text-align:right;\"> 0.4584896 </td>\n   <td style=\"text-align:right;\"> -0.2071764 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n## Calculate with standard equation \n```\n:::\n\n\n### Interpreting Confidence Intervals of Predicted Outcomes\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## CIs are currently in logit... switch to response scale \n\n# Build prediction grid of all combinations of DT and PreyCat \npredicted_data <- expand.grid(\n  # Establish sequence for predictor range (DT)\n  DT = seq(min(forage$DT, na.rm = TRUE), max(forage$DT, na.rm = TRUE), length.out = 100),\n  PreyCat = levels(factor(forage$PreyCat)) # Convert to factor\n)\n\n# Ensure levels in predicted_data exactly match in forage$PreyCat\npredicted_data$PreyCat <- factor(predicted_data$PreyCat, levels = levels(factor(forage$PreyCat)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predict on logit link scale with SEs\npred_link <- predict(\n  forage_beta,\n  newdata = predicted_data,\n  type = \"link\",\n  se.fit = TRUE\n)\n\n# Predict on logit link scale with standard errors\npredicted_data$fit    <- pred_link$fit\npredicted_data$se.fit <- pred_link$se.fit\n\n# CIs on link scale\npredicted_data$lower_link <- predicted_data$fit - 1.96 * predicted_data$se.fit\npredicted_data$upper_link <- predicted_data$fit + 1.96 * predicted_data$se.fit\n\n# Revert to response scale usinng inverse logit\ninv_logit <- function(x) 1 / (1 + exp(-x))\n#\npredicted_data$predicted_PropNotEat_adj <- inv_logit(predicted_data$fit)\npredicted_data$lower <- inv_logit(predicted_data$lower_link)\npredicted_data$upper <- inv_logit(predicted_data$upper_link)\n\n# Select only categories you want to plot\npredicted_ribbon <- predicted_data %>%\n  filter(PreyCat %in% c(\"Clam\", \"Urchin\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\n# Plot fitted lines per prey category\npredicted_data %>% \n  ggplot(aes(x = DT, y = predicted_PropNotEat_adj, color = PreyCat)) +\n  geom_line(size = 1) + \n  labs(\n    title = \"Effect of Dive Time on Predicted Proportion Not Eaten Based on Prey Category\",\n    x = \"Dive Time (seconds)\",\n    y = \"Predicted Proportion Not Eaten\"\n  ) + facet_wrap(~ PreyCat) +\n  theme_minimal() +\n  scale_color_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](final_draft_copy_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Ribbon\npredicted_data %>% filter(PreyCat %in% c(\"Clam\", \"Urchin\")) %>%\nggplot(aes(x = DT, y = predicted_PropNotEat_adj, color = PreyCat)) +\n  # Ribbon for Clam and Urchin\n  geom_ribbon(\n    data = predicted_ribbon,\n    aes(ymin = lower, ymax = upper, fill = PreyCat),\n    alpha = 0.2,\n    color = NA\n  ) +\n  # Predicted lines for all categories\n  geom_line(size = 1) +\n  labs(\n    title = \"Effect of Dive Time on Predicted Proportion Not Eaten by Prey Category\",\n    x = \"Dive Time (seconds)\",\n    y = \"Predicted Proportion Not Eaten\"\n  ) +\n  theme_minimal() + \n  scale_color_brewer(palette = \"Set1\") +\n  scale_fill_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](final_draft_copy_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nFor future analysis, the age (adult and juvenile) of observed sea otters may be considered as a potential confounding variable impacting diving time, preference for prey, and the proportion of prey left uneaten.\n",
    "supporting": [
      "final_draft_copy_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}